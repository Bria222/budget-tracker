(this["webpackJsonpbudget-tracker"]=this["webpackJsonpbudget-tracker"]||[]).push([[26],{148:function(t,e,r){"use strict";function n(t){return function(t){if(Array.isArray(t)){for(var e=0,r=new Array(t.length);e<t.length;e++)r[e]=t[e];return r}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}r.d(e,"a",(function(){return n}))},165:function(t,e,r){"use strict";function n(t,e){return t/e}r.d(e,"a",(function(){return n}))},209:function(t,e,r){"use strict";r.d(e,"a",(function(){return u}));var n=r(2),a=r.n(n),s=r(4),i=r(14),c=r(18),u=function(){function t(e){Object(i.a)(this,t),this.baseUrl=void 0,this.baseUrl=e}return Object(c.a)(t,[{key:"getUrl",value:function(t,e){var r=new URL("".concat(this.baseUrl,"/").concat(t));return Object.keys(e).forEach((function(t){return r.searchParams.append(t,e[t])})),r.toString()}},{key:"fetch",value:function(t){function e(e,r){return t.apply(this,arguments)}return e.toString=function(){return t.toString()},e}(function(){var t=Object(s.a)(a.a.mark((function t(e,r){var n;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,fetch(e,r);case 2:if(!(n=t.sent).ok){t.next=5;break}return t.abrupt("return",n.json());case 5:throw new Error("Error fetching ".concat(e," > ").concat(n.status));case 6:case"end":return t.stop()}}),t)})));return function(e,r){return t.apply(this,arguments)}}())},{key:"get",value:function(){var t=Object(s.a)(a.a.mark((function t(e,r){var n;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=this.getUrl(e,r),t.abrupt("return",this.fetch(n,{method:"GET"}));case 2:case"end":return t.stop()}}),t,this)})));return function(e,r){return t.apply(this,arguments)}}()}]),t}()},326:function(t,e,r){"use strict";r.r(e);var n=r(148),a=r(36),s=r(2),i=r.n(s),c=r(4),u=r(14),o=r(18),h=r(209),p=new(function(){function t(){Object(u.a)(this,t),this.primary=void 0,this._backup=void 0,this.primary=new h.a("https://api.currencystack.io")}return Object(o.a)(t,[{key:"getRatesBackup",value:function(){var t=Object(c.a)(i.a.mark((function t(e){return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",this.backup.get("latest",{base:e}));case 1:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}()},{key:"getRatesPrimary",value:function(){var t=Object(c.a)(i.a.mark((function t(e,r){return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",this.primary.get("currency",{base:e,target:Array.from(r).join(","),apikey:"T0272d9a397f6cf710dd40c09df0626c"}));case 1:case"end":return t.stop()}}),t,this)})));return function(e,r){return t.apply(this,arguments)}}()},{key:"getRates",value:function(){var t=Object(c.a)(i.a.mark((function t(e,r,n){var a;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,this.getRatesPrimary(e,r);case 3:a=t.sent,t.next=12;break;case 6:return t.prev=6,t.t0=t.catch(0),console.warn("Trying to fetch backup API: ",t.t0),t.next=11,this.getRatesBackup(e);case 11:a=t.sent;case 12:if(t.prev=12,a){t.next=15;break}throw new Error("There is no response for ".concat(e));case 15:if(!n||!a||n in a.rates){t.next=17;break}throw new Error("There is no match for ".concat(e," => ").concat(n));case 17:if(!(Object.keys(a.rates).length<=0)){t.next=19;break}throw new Error("Empty response for ".concat(e));case 19:return t.abrupt("return",a);case 21:case"end":return t.stop()}}),t,this,[[0,6,12,21]])})));return function(e,r,n){return t.apply(this,arguments)}}()},{key:"backup",get:function(){return void 0===this._backup&&(this._backup=new h.a("https://api.exchangeratesapi.io")),this._backup}}]),t}()),f=r(165);function l(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function v(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?l(r,!0).forEach((function(e){Object(a.a)(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):l(r).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}r.d(e,"CurrenciesStoreImpl",(function(){return y}));var y=function(){function t(e){Object(u.a)(this,t),this.currencies=void 0,this._rates=void 0,this._timestamps=void 0,this._countriesCurrencyMap=void 0,this._lastCurrenciesUsed=void 0,this.currencies=new Map(Object.entries(e)),this._timestamps=this.getTimestampsFromDisk(),this._rates=this.getRatesFromDisk()}return Object(o.a)(t,[{key:"getRate",value:function(){var t=Object(c.a)(i.a.mark((function t(e,r){var n;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=void 0,this.shouldFetch(e,r)&&(n=this.fetchRates(e,r)),!n||this.isPresent(e,r)){t.next=11;break}return t.prev=3,t.next=6,n;case 6:t.next=11;break;case 8:t.prev=8,t.t0=t.catch(3),console.warn(t.t0);case 11:return t.abrupt("return",this._rates[e].rates[r]);case 12:case"end":return t.stop()}}),t,this,[[3,8]])})));return function(e,r){return t.apply(this,arguments)}}()},{key:"getLocalRates",value:function(t){return this._rates&&this._rates[t]}},{key:"getRates",value:function(){var t=Object(c.a)(i.a.mark((function t(e){var r;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=void 0,this.shouldFetch(e)&&(r=this.fetchRates(e)),!r){t.next=11;break}return t.prev=3,t.next=6,r;case 6:t.next=11;break;case 8:t.prev=8,t.t0=t.catch(3),console.warn(t.t0);case 11:return t.abrupt("return",this._rates[e]);case 12:case"end":return t.stop()}}),t,this,[[3,8]])})));return function(e){return t.apply(this,arguments)}}()},{key:"getAmountInBaseCurrency",value:function(){var t=Object(c.a)(i.a.mark((function t(e,r,n){var a;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!e||r===e){t.next=5;break}return t.next=3,this.getRate(e,r);case 3:return a=t.sent,t.abrupt("return",Object(f.a)(n,a));case 5:return t.abrupt("return",n);case 6:case"end":return t.stop()}}),t,this)})));return function(e,r,n){return t.apply(this,arguments)}}()},{key:"isUpdated",value:function(t){return t in this._timestamps&&this.isTimestampUpdated(this._timestamps[t])}},{key:"isTimestampUpdated",value:function(e){return Date.now()-e<=t.UPDATE_RATES_MS}},{key:"fetchRates",value:function(){var t=Object(c.a)(i.a.mark((function t(e,r){var n,a;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,p.getRates(e,this.currencies.keys(),r);case 2:n=t.sent,Object.keys(n.rates).length>0&&(a=this._rates[e]||{},this._rates[e]=v({},a,{},n),this._timestamps[e]=Date.now(),this.saveTimestampsToDisk(),this.saveRatesToDisk());case 4:case"end":return t.stop()}}),t,this)})));return function(e,r){return t.apply(this,arguments)}}()},{key:"shouldFetch",value:function(t,e){return void 0===this._rates||!(t in this._rates)||!this.isUpdated(t)||e&&!this.isPresent(t,e)}},{key:"isPresent",value:function(t,e){return this._rates&&t in this._rates&&e in this._rates[t].rates}},{key:"getRatesFromDisk",value:function(){var e=localStorage.getItem(t.KEY);return e&&e.length>0?JSON.parse(e):{}}},{key:"getTimestampsFromDisk",value:function(){var e=localStorage.getItem(t.KEY_TS);return e&&e.length>0?JSON.parse(e):{}}},{key:"saveRatesToDisk",value:function(){localStorage.setItem(t.KEY,JSON.stringify(this._rates))}},{key:"saveTimestampsToDisk",value:function(){localStorage.setItem(t.KEY_TS,JSON.stringify(this._timestamps))}},{key:"getFromCountry",value:function(){var t=Object(c.a)(i.a.mark((function t(e){var n,a;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this._countriesCurrencyMap){t.next=5;break}return t.next=3,r.e(79).then(r.t.bind(null,317,3));case 3:n=t.sent,this._countriesCurrencyMap=n.default;case 5:return(a=this._countriesCurrencyMap[e])&&this.setLastCurrencyUsed(a),t.abrupt("return",a);case 8:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}()},{key:"setLastCurrencyUsed",value:function(e){this._lastCurrenciesUsed=[e].concat(Object(n.a)(this.lastCurrenciesUsed.filter((function(t){return t!==e})))),localStorage.setItem(t.KEY_LAST,JSON.stringify(Array.from(this.lastCurrenciesUsed).slice(0,5)))}},{key:"lastCurrenciesUsed",get:function(){if(!this._lastCurrenciesUsed){var e=localStorage.getItem(t.KEY_LAST);if(e)try{var r=JSON.parse(e);this._lastCurrenciesUsed=Object(n.a)(r)}catch(a){console.warn(a),this._lastCurrenciesUsed=[]}else this._lastCurrenciesUsed=[]}return this._lastCurrenciesUsed}},{key:"lastCurrencyUsed",get:function(){return this.lastCurrenciesUsed[0]}}]),t}();y.KEY="currencyRates",y.KEY_TS="currencyTimestamps",y.KEY_LAST="lastCurrencies",y.UPDATE_RATES_MS=432e5}}]);
//# sourceMappingURL=26.e1573132.chunk.js.map