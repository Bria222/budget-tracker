(this["webpackJsonpbudget-tracker"]=this["webpackJsonpbudget-tracker"]||[]).push([[5],{26:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e.ImportExport="/import-export",e.About="/about",e.Sync="/sync",e.Privacy="/privacy"}(r||(r={}))},29:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(14),a=n(18),s=function(){function e(t){Object(r.a)(this,e),this.path=void 0,this.path="".concat(e.base,"/").concat(t)}return Object(a.a)(e,[{key:"pathExpensesByDay",value:function(e,t,n){var r=void 0===t?"":"&month=".concat(t),a=void 0===n?"":"&day=".concat(n);return"".concat(this.pathExpenses,"?year=").concat(e).concat(r).concat(a)}},{key:"pathExpensesByCategory",value:function(e){return"".concat(this.pathExpenses,"?category=").concat(e)}},{key:"pathEdit",get:function(){return"".concat(this.path,"/edit")}},{key:"pathStats",get:function(){return"".concat(this.path,"/stats")}},{key:"pathExport",get:function(){return"".concat(this.path,"/export")}},{key:"pathExpenses",get:function(){return"".concat(this.path,"/expenses")}},{key:"pathAddExpense",get:function(){return"".concat(this.path,"/expenses/add")}},{key:"exportPath",get:function(){return"".concat(this.path,"/export")}}],[{key:"pathCombinedWithQuery",value:function(e){var t=new URLSearchParams,n=!0,r=!1,a=void 0;try{for(var s,i=e[Symbol.iterator]();!(n=(s=i.next()).done);n=!0){var u=s.value;t.append("identifiers[]",u)}}catch(c){r=!0,a=c}finally{try{n||null==i.return||i.return()}finally{if(r)throw a}}return"".concat(this.combined,"?").concat(t.toString())}},{key:"base",get:function(){return"/budgets"}},{key:"add",get:function(){return"".concat(this.base,"/add")}},{key:"combined",get:function(){return"".concat(this.base,"/combined")}}]),e}()},37:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e.List="/categories",e.Add="/categories/add"}(r||(r={}))},40:function(e,t,n){"use strict";n.d(t,"a",(function(){return s})),n.d(t,"b",(function(){return i}));var r=n(0),a=Object(r.createContext)(void 0),s=a.Provider;a.Consumer;function i(){var e=Object(r.useContext)(a);if(void 0===e)throw new Error("useAppContext must be used within a AppProvider");return e}},51:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(40);function a(){var e=Object(r.b)();return function(t){return e.localization.get(t)}}},57:function(e,t,n){"use strict";n.d(t,"a",(function(){return p})),n.d(t,"b",(function(){return h}));var r=n(16),a=n(0),s=n.n(a),i=n(94),u=n(96),c=n(52),o=n.n(c),l=function(e){var t=s.a.useState(),n=Object(r.a)(t,2),a=n[0],c=n[1],l=e.type||"default",p="".concat(l,"-message-id");function h(){c(!0)}return s.a.createElement(u.a,{anchorOrigin:{vertical:"bottom",horizontal:"left"},open:!a,autoHideDuration:6e3,onClose:h,ContentProps:{"aria-describedby":p},message:s.a.createElement("span",{id:p},e.message),action:[s.a.createElement(i.a,{key:"close","aria-label":"Close",color:"inherit",onClick:h},s.a.createElement(o.a,null))]})},p=function(e){return s.a.createElement(l,Object.assign({type:"error"},e))},h=function(e){return s.a.createElement(l,Object.assign({type:"info"},e))}},58:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(68),a=n.n(r);function s(){return a()()}},65:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(14),a=function e(t,n){Object(r.a)(this,e),this.path=void 0,this.path="".concat(n.path,"/expenses/").concat(t)}},81:function(e,t,n){e.exports=n(92)},92:function(e,t,n){"use strict";n.r(t);var r=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function a(e,t){navigator.serviceWorker.register(e).then((function(e){e.onupdatefound=function(){var n=e.installing;null!=n&&(n.onstatechange=function(){"installed"===n.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See https://bit.ly/CRA-PWA."),t&&t.onUpdate&&t.onUpdate(e)):(console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(e)))})}})).catch((function(e){console.error("Error during service worker registration:",e)}))}var s=n(12),i=n.n(s),u=n(0),c=n.n(u),o=n(16),l=n(131),p=n(132),h=n(133),f=n(94),d=n(67),b=n.n(d),v=n(104),g=n(126),m=n(41),x=n(51),y=n(29),w=n(37),k=n(26),E=function(){var e=u.useState(null),t=Object(o.a)(e,2),n=t[0],r=t[1],a=Object(x.a)(),s=function(){return r(null)},i=u.forwardRef((function(e,t){return u.createElement(g.a,{onClick:s,component:m.b,to:e.path},e.name)}));return u.createElement(u.Fragment,null,u.createElement(f.a,{edge:"start",color:"inherit","aria-label":"Menu",onClick:function(e){return r(e.currentTarget)}},u.createElement(b.a,null)),u.createElement(v.a,{id:"app-menu",anchorEl:n,keepMounted:!0,open:Boolean(n),onClose:s},u.createElement(i,{name:a("Budgets"),path:y.a.base}),u.createElement(i,{name:a("Categories"),path:w.a.List}),u.createElement(i,{name:a("Import & Export"),path:k.a.ImportExport}),u.createElement(i,{name:a("Account sync"),path:k.a.Sync}),u.createElement(i,{name:a("About"),path:k.a.About})))},O=function(e){return u.createElement(l.a,{position:"sticky"},u.createElement(p.a,null,u.createElement(E,null),u.createElement(h.a,{color:"inherit",variant:"h6",style:{flexGrow:1}},e.title),e.actions))},j=n(10),S=n(65),C=n(134),B={BudgetView:u.lazy((function(){return Promise.all([n.e(0),n.e(19),n.e(10)]).then(n.bind(null,320))})),BudgetList:u.lazy((function(){return Promise.all([n.e(14),n.e(23)]).then(n.bind(null,324))})),BudgetCombined:u.lazy((function(){return Promise.all([n.e(4),n.e(24),n.e(11)]).then(n.bind(null,328))})),BudgetEdit:u.lazy((function(){return Promise.all([n.e(1),n.e(12)]).then(n.bind(null,329))})),BudgetStats:u.lazy((function(){return Promise.all([n.e(4),n.e(20)]).then(n.bind(null,259))})),BudgetExport:u.lazy((function(){return n.e(9).then(n.bind(null,260))})),ExpenseView:u.lazy((function(){return Promise.all([n.e(1),n.e(0),n.e(2),n.e(35)]).then(n.bind(null,261))})),ExpenseAdd:u.lazy((function(){return Promise.all([n.e(1),n.e(0),n.e(2),n.e(28)]).then(n.bind(null,330))})),ExpensesView:u.lazy((function(){return Promise.all([n.e(15),n.e(16)]).then(n.bind(null,319))})),CategoryList:u.lazy((function(){return Promise.all([n.e(1),n.e(0),n.e(13)]).then(n.bind(null,262))})),AddCategory:u.lazy((function(){return Promise.all([n.e(1),n.e(0),n.e(17)]).then(n.bind(null,263))})),ImportExport:u.lazy((function(){return n.e(8).then(n.bind(null,321))})),About:u.lazy((function(){return n.e(21).then(n.bind(null,264))})),Sync:u.lazy((function(){return n.e(18).then(n.bind(null,265))})),Privacy:u.lazy((function(){return n.e(27).then(n.bind(null,266))}))};function P(e,t){return function(n){return u.createElement(u.Suspense,{fallback:u.createElement(C.a,null)},u.createElement(e,Object.assign({},n,t)))}}var A,I,_=new y.a(":budgetId"),D=new S.a(":expenseId",_),L=function(e){return u.createElement(j.d,null,u.createElement(j.b,{exact:!0,path:y.a.base,render:P(B.BudgetList,e)}),u.createElement(j.b,{exact:!0,path:y.a.add,render:P(B.BudgetEdit,e)}),u.createElement(j.b,{exact:!0,path:y.a.combined,render:P(B.BudgetCombined,e)}),u.createElement(j.b,{exact:!0,path:_.pathEdit,render:P(B.BudgetEdit,e)}),u.createElement(j.b,{exact:!0,path:_.pathStats,render:P(B.BudgetStats,e)}),u.createElement(j.b,{exact:!0,path:_.pathExport,render:P(B.BudgetExport,e)}),u.createElement(j.b,{exact:!0,path:_.path,render:P(B.BudgetView,e)}),u.createElement(j.b,{exact:!0,path:_.pathAddExpense,render:P(B.ExpenseAdd,e)}),u.createElement(j.b,{exact:!0,path:D.path,render:P(B.ExpenseView,e)}),u.createElement(j.b,{exact:!0,path:_.pathExpenses,render:P(B.ExpensesView,e)}),u.createElement(j.b,{exact:!0,path:w.a.List,render:P(B.CategoryList,e)}),u.createElement(j.b,{exact:!0,path:w.a.Add,render:P(B.AddCategory,e)}),u.createElement(j.b,{exact:!0,path:"/",render:P(B.BudgetList,e)}),u.createElement(j.b,{exact:!0,path:k.a.ImportExport,render:P(B.ImportExport,e)}),u.createElement(j.b,{exact:!0,path:k.a.About,render:P(B.About,e)}),u.createElement(j.b,{exact:!0,path:k.a.Sync,render:P(B.Sync,e)}),u.createElement(j.b,{exact:!0,path:k.a.Privacy,render:P(B.Privacy,e)}))},T=n(135),z=n(136),R=n(139),F=n(14),W=n(18),U=n(60),V=n(55),N=n(59),K=n(57),J=function(e){function t(e){var n;return Object(F.a)(this,t),(n=Object(U.a)(this,Object(V.a)(t).call(this,e))).state={error:null},n}return Object(N.a)(t,e),Object(W.a)(t,[{key:"componentDidCatch",value:function(e,t){console.error(e,t),this.setState({error:e.message})}},{key:"render",value:function(){return this.state.error?u.createElement(K.a,{message:this.state.error}):this.props.children}}]),t}(u.Component),M=n(40),G=function(e){var t=c.a.useState("Budget tracker"),n=Object(o.a)(t,2),r=n[0],a=n[1],s=c.a.useState(),i=Object(o.a)(s,2),u=i[0],l=i[1];return c.a.createElement(m.a,{basename:"/budget-tracker"},c.a.createElement(M.a,{value:e.btApp},c.a.createElement(R.a,null),c.a.createElement(O,{title:r,actions:u}),c.a.createElement("main",null,c.a.createElement(T.a,{maxWidth:"lg"},c.a.createElement(z.a,{mt:2,marginBottom:8},c.a.createElement(J,null,c.a.createElement(L,{onTitleChange:a,onActions:l})))))))},H=n(2),Q=n.n(H),$=n(4),q=function(){function e(t,n){Object(F.a)(this,e),this.from=void 0,this.to=void 0,this.name=void 0,this.from=t,this.to=n,this.name="".concat(this.from.constructor.name," > ").concat(this.to.constructor.name)}return Object(W.a)(e,[{key:"sync",value:function(){var e=Object($.a)(Q.a.mark((function e(){var t;return Q.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.debug(this.name),e.next=3,this.from.export();case 3:if(!(t=e.sent)){e.next=6;break}return e.abrupt("return",this.to.import(t));case 6:console.info("Nothing to sync");case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),e}(),X=n(58),Y=function(){function e(t){Object(F.a)(this,e),this.local=void 0,this.remote=void 0,this.observers=void 0,console.log("Instantiated",this),this.local=t,this.observers=new Set}return Object(W.a)(e,[{key:"addObserver",value:function(e){this.observers.add(e)}},{key:"deleteObserver",value:function(e){this.observers.delete(e)}},{key:"notifyObservers",value:function(){this.observers.forEach((function(e){return e.onStorageDataChanged()}))}},{key:"loadDeviceId",value:function(){var e=localStorage.getItem("deviceId");if(e)return e;console.debug("First time app starts, generating device ID");var t=Object(X.a)();return localStorage.setItem("deviceId",t),t}},{key:"setRemote",value:function(){var e=Object($.a)(Q.a.mark((function e(t){return Q.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.remote===t){e.next=4;break}if(this.remote=t,!this.remote){e.next=4;break}return e.abrupt("return",this.sync());case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"sync",value:function(){var e=Object($.a)(Q.a.mark((function e(){var t,n,r,a;return Q.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.remote){e.next=21;break}return e.next=3,Promise.all([this.remote.getLastTimeSaved(),this.local.getLastTimeSaved()]);case 3:if(t=e.sent,n=Object(o.a)(t,2),r=n[0],a=n[1],!(r>a)){e.next=12;break}return e.next=10,new q(this.remote,this.local).sync();case 10:e.next=19;break;case 12:if(!(r<a)){e.next=17;break}return e.next=15,new q(this.local,this.remote).sync();case 15:e.next=19;break;case 17:return console.debug("Nothing to sync"),e.abrupt("return");case 19:this.notifyObservers(),console.debug("Sync done");case 21:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getBudget",value:function(){var e=Object($.a)(Q.a.mark((function e(t){return Q.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.local.getBudget(t));case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getBudgets",value:function(){var e=Object($.a)(Q.a.mark((function e(){return Q.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.local.getBudgets());case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getExpenses",value:function(){var e=Object($.a)(Q.a.mark((function e(t){return Q.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.local.getExpenses(t));case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"setBudget",value:function(){var e=Object($.a)(Q.a.mark((function e(t){var n,r,a=arguments;return Q.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=a.length>1&&void 0!==a[1]?a[1]:Date.now(),r=this.local.setBudget(t,n),this.remote&&this.remote.setBudget(t,n),e.abrupt("return",r);case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"deleteBudget",value:function(){var e=Object($.a)(Q.a.mark((function e(t){var n,r,a=arguments;return Q.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=a.length>1&&void 0!==a[1]?a[1]:Date.now(),r=this.local.deleteBudget(t,n),this.remote&&this.remote.deleteBudget(t,n),e.abrupt("return",r);case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getExpense",value:function(){var e=Object($.a)(Q.a.mark((function e(t){return Q.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.local.getExpense(t));case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"setExpenses",value:function(){var e=Object($.a)(Q.a.mark((function e(t){var n,r,a=arguments;return Q.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=a.length>1&&void 0!==a[1]?a[1]:Date.now(),r=this.local.setExpenses(t,n),this.remote&&this.remote.setExpenses(t,n),e.abrupt("return",r);case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"deleteExpense",value:function(){var e=Object($.a)(Q.a.mark((function e(t){var n,r,a=arguments;return Q.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=a.length>1&&void 0!==a[1]?a[1]:Date.now(),r=this.local.deleteExpense(t,n),this.remote&&this.remote.deleteExpense(t,n),e.abrupt("return",r);case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getCategory",value:function(){var e=Object($.a)(Q.a.mark((function e(t){return Q.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.local.getCategory(t));case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getCategories",value:function(){var e=Object($.a)(Q.a.mark((function e(){return Q.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.local.getCategories());case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"setCategories",value:function(){var e=Object($.a)(Q.a.mark((function e(t){var n,r,a=arguments;return Q.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=a.length>1&&void 0!==a[1]?a[1]:Date.now(),r=this.local.setCategories(t,n),this.remote&&this.remote.setCategories(t,n),e.abrupt("return",r);case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"deleteCategory",value:function(){var e=Object($.a)(Q.a.mark((function e(t){var n,r,a=arguments;return Q.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=a.length>1&&void 0!==a[1]?a[1]:Date.now(),r=this.local.deleteCategory(t,n),this.remote&&this.remote.deleteCategory(t,n),e.abrupt("return",r);case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),e}(),Z=n(36),ee=n(69);function te(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ne(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?te(n,!0).forEach((function(t){Object(Z.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):te(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}!function(e){e.RemoteToLocal="RemoteToLocal",e.LocalToRemote="LocalToRemote"}(A||(A={})),function(e){e.Budgets="budgets",e.Expenses="expenses",e.Categories="categories"}(I||(I={}));var re,ae={keyPath:"identifier"},se=function(){function e(){Object(F.a)(this,e),this.name="budgetTrackerDb",this.version=1,this._db=void 0}return Object(W.a)(e,[{key:"createDb",value:function(){var e=Object($.a)(Q.a.mark((function e(){return Q.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Object(ee.a)(this.name,this.version,{upgrade:function(e){e.createObjectStore(I.Budgets,ae).createIndex("deleted, to",["deleted","to"]),e.createObjectStore(I.Categories,ae).createIndex("deleted, name",["deleted","name"]),e.createObjectStore(I.Expenses,ae).createIndex("deleted, budgetId, when",["deleted","budgetId","when"])}}));case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"enablePersistentStorage",value:function(){var e=Object($.a)(Q.a.mark((function e(){var t,n;return Q.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=navigator,n=t.storage,e.t0=n&&n.persist,!e.t0){e.next=6;break}return e.next=5,n.persist();case 5:e.t0=e.sent;case 6:e.t0?console.info("Storage will not be cleared except by explicit user action"):console.warn("Storage may be cleared by the UA under storage pressure.");case 8:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"getDb",value:function(){var e=Object($.a)(Q.a.mark((function e(){return Q.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0!==this._db){e.next=6;break}return e.next=3,this.enablePersistentStorage();case 3:return e.next=5,this.createDb();case 5:this._db=e.sent;case 6:return e.abrupt("return",this._db);case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getBudgets",value:function(){var e=Object($.a)(Q.a.mark((function e(){var t,n,r,a;return Q.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getDb();case 2:return t=e.sent,n=IDBKeyRange.upperBound([1,0]),e.next=6,t.getAllFromIndex(I.Budgets,"deleted, to",n);case 6:return r=e.sent,a={},r.forEach((function(e){return a[e.identifier]=e})),e.abrupt("return",a);case 10:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getBudget",value:function(){var e=Object($.a)(Q.a.mark((function e(t){var n;return Q.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getDb();case 2:return n=e.sent,e.abrupt("return",n.get(I.Budgets,t));case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"setBudget",value:function(){var e=Object($.a)(Q.a.mark((function e(t,n){var r;return Q.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getDb();case 2:return r=e.sent,e.next=5,r.put(I.Budgets,ne({deleted:0,timestamp:n},t));case 5:return e.abrupt("return",this.setLastTimeSaved(n));case 6:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"deleteBudget",value:function(){var e=Object($.a)(Q.a.mark((function e(t){var n,r,a,s,i=arguments;return Q.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=i.length>1&&void 0!==i[1]?i[1]:Date.now(),e.next=3,this.getDb();case 3:return r=e.sent,a=r.transaction(I.Budgets,"readwrite"),e.next=7,a.store.get(t);case 7:return(s=e.sent)&&a.store.put(ne({},s,{deleted:1,timestamp:n})),e.next=11,a.done;case 11:this.setLastTimeSaved(n);case 12:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getExpenses",value:function(){var e=Object($.a)(Q.a.mark((function e(t){var n,r,a,s,i;return Q.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getDb();case 2:return n=e.sent,e.next=5,n.get(I.Budgets,t);case 5:if(!(r=e.sent)){e.next=14;break}return a=IDBKeyRange.bound([0,t,r.from],[0,t,r.to]),e.next=10,n.getAllFromIndex(I.Expenses,"deleted, budgetId, when",a);case 10:return s=e.sent,i={},s.forEach((function(e){return i[e.identifier]=e})),e.abrupt("return",i);case 14:throw new Error("There is no budget with id "+t);case 15:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getAllExpenses",value:function(){var e=Object($.a)(Q.a.mark((function e(){var t,n,r;return Q.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getDb();case 2:return t=e.sent,e.next=5,t.getAll(I.Expenses);case 5:return n=e.sent,r={},n.forEach((function(e){return r[e.identifier]=e})),e.abrupt("return",r);case 9:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getExpense",value:function(){var e=Object($.a)(Q.a.mark((function e(t){var n;return Q.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getDb();case 2:return n=e.sent,e.abrupt("return",n.get(I.Expenses,t));case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"setExpenses",value:function(){var e=Object($.a)(Q.a.mark((function e(t,n){var r,a,s,i,u,c,o,l;return Q.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getDb();case 2:for(r=e.sent,a=r.transaction(I.Expenses,"readwrite"),s=!0,i=!1,u=void 0,e.prev=7,c=t[Symbol.iterator]();!(s=(o=c.next()).done);s=!0)l=o.value,a.store.put(ne({},l,{timestamp:n,deleted:0}));e.next=15;break;case 11:e.prev=11,e.t0=e.catch(7),i=!0,u=e.t0;case 15:e.prev=15,e.prev=16,s||null==c.return||c.return();case 18:if(e.prev=18,!i){e.next=21;break}throw u;case 21:return e.finish(18);case 22:return e.finish(15);case 23:return e.next=25,a.done;case 25:return e.abrupt("return",this.setLastTimeSaved(n));case 26:case"end":return e.stop()}}),e,this,[[7,11,15,23],[16,,18,22]])})));return function(t,n){return e.apply(this,arguments)}}()},{key:"deleteExpense",value:function(){var e=Object($.a)(Q.a.mark((function e(t,n){var r,a,s;return Q.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getDb();case 2:return r=e.sent,a=r.transaction(I.Expenses,"readwrite"),e.next=6,a.store.get(t);case 6:return(s=e.sent)&&a.store.put(ne({},s,{deleted:1,timestamp:n})),e.next=10,a.done;case 10:return e.abrupt("return",this.setLastTimeSaved(n));case 11:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"getCategories",value:function(){var e=Object($.a)(Q.a.mark((function e(){var t,n,r,a;return Q.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getDb();case 2:return t=e.sent,n=IDBKeyRange.upperBound([1],!0),e.next=6,t.getAllFromIndex(I.Categories,"deleted, name",n);case 6:return r=e.sent,a={},r&&r.forEach((function(e){return a[e.identifier]=e})),e.abrupt("return",a);case 10:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"setCategories",value:function(){var e=Object($.a)(Q.a.mark((function e(t,n){var r,a,s,i,u,c,o,l;return Q.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getDb();case 2:for(r=e.sent,a=r.transaction(I.Categories,"readwrite"),s=!0,i=!1,u=void 0,e.prev=7,c=t[Symbol.iterator]();!(s=(o=c.next()).done);s=!0)l=o.value,a.store.put(ne({},l,{timestamp:n,deleted:0}));e.next=15;break;case 11:e.prev=11,e.t0=e.catch(7),i=!0,u=e.t0;case 15:e.prev=15,e.prev=16,s||null==c.return||c.return();case 18:if(e.prev=18,!i){e.next=21;break}throw u;case 21:return e.finish(18);case 22:return e.finish(15);case 23:return e.next=25,a.done;case 25:return e.abrupt("return",this.setLastTimeSaved(n));case 26:case"end":return e.stop()}}),e,this,[[7,11,15,23],[16,,18,22]])})));return function(t,n){return e.apply(this,arguments)}}()},{key:"getCategory",value:function(){var e=Object($.a)(Q.a.mark((function e(t){var n;return Q.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getDb();case 2:return n=e.sent,e.abrupt("return",n.get(I.Categories,t));case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"deleteCategory",value:function(){var e=Object($.a)(Q.a.mark((function e(t,n){var r,a,s;return Q.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getDb();case 2:return r=e.sent,a=r.transaction(I.Categories,"readwrite"),e.next=6,a.store.get(t);case 6:return(s=e.sent)&&a.objectStore(I.Categories).put(ne({},s,{timestamp:n,deleted:1})),e.next=10,a.done;case 10:return e.abrupt("return",this.setLastTimeSaved(n));case 11:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"import",value:function(){var e=Object($.a)(Q.a.mark((function e(t){var n,r,a,s,i,u;return Q.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getDb();case 2:for(s in n=e.sent,r=n.transaction([I.Budgets,I.Categories,I.Expenses],"readwrite"),a={deleted:0,timestamp:t.lastTimeSaved},t.budgets)r.objectStore(I.Budgets).put(ne({},a,{},t.budgets[s]));for(i in t.expenses)r.objectStore(I.Expenses).put(ne({},a,{},t.expenses[i]));for(u in t.categories)r.objectStore(I.Categories).put(ne({},a,{},t.categories[u]));return e.next=10,r.done;case 10:return e.abrupt("return",this.setLastTimeSaved(t.lastTimeSaved));case 11:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"export",value:function(){var e=Object($.a)(Q.a.mark((function e(){var t,n,r,a,s,i;return Q.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([this.getBudgets(),this.getCategories(),this.getAllExpenses(),this.getLastTimeSaved()]);case 2:return t=e.sent,n=Object(o.a)(t,4),r=n[0],a=n[1],s=n[2],i=n[3],e.abrupt("return",{budgets:r,expenses:s,categories:a,lastTimeSaved:i});case 9:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getLastTimeSaved",value:function(){var e=Object($.a)(Q.a.mark((function e(){return Q.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",parseInt(localStorage.getItem("timestamp")||"0"));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"setLastTimeSaved",value:function(){var e=Object($.a)(Q.a.mark((function e(t){return Q.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:localStorage.setItem("timestamp",t.toString());case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}]),e}(),ie="en",ue=(re={},Object(Z.a)(re,ie,n.e(81).then(n.t.bind(null,273,3))),Object(Z.a)(re,"es",n.e(82).then(n.t.bind(null,274,3))),re),ce=function(){function e(t){Object(F.a)(this,e),this.lang=void 0,this.strings=void 0,t=t.slice(0,2),this.lang=t in ue?t:ie,this.strings={},this.initStrings()}return Object(W.a)(e,[{key:"initStrings",value:function(){var e=Object($.a)(Q.a.mark((function e(){var t,n=this;return Q.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ue[this.lang];case 2:t=e.sent.default,Object.entries(t).forEach((function(e){var t=Object(o.a)(e,2),r=t[0],a=t[1];return n.strings[r]=a}));case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"get",value:function(e){return this.strings[e]||e}}]),e}(),oe=new(function(){function e(){var t=this;Object(F.a)(this,e),this.storage=void 0,this.localization=void 0,this._firestore=void 0,this._auth=void 0,this._authPromise=void 0,this._budgetsStore=void 0,this._categoriesStore=void 0,this._iconsStore=void 0,this._currenciesStore=void 0,this._countriesStore=void 0,this.onAuth=function(){var e=Object($.a)(Q.a.mark((function e(n){return Q.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=t.storage,e.next=3,t.initFirestore(n);case 3:e.t1=e.sent,e.t0.setRemote.call(e.t0,e.t1);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.initBgAuth(),this.storage=new Y(new se),this.localization=new ce(navigator.language)}return Object(W.a)(e,[{key:"initBgAuth",value:function(){var e=Object($.a)(Q.a.mark((function e(){return Q.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.debug("Fetching auth info..."),e.t0=console,e.next=4,this.getAuth();case 4:return e.next=6,e.sent.getUserId();case 6:e.t1=e.sent,e.t0.debug.call(e.t0,"Auth: ",e.t1);case 8:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"initFirestore",value:function(){var e=Object($.a)(Q.a.mark((function e(t){var r;return Q.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t){e.next=14;break}if(this._firestore){e.next=12;break}return e.prev=2,e.next=5,Promise.all([n.e(3),n.e(25),n.e(34)]).then(n.bind(null,267));case 5:r=e.sent,this._firestore=new r.FirestoreApi(t,!0),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(2),console.warn("Cannot get user ID: ",e.t0);case 12:e.next=15;break;case 14:this._firestore=void 0;case 15:return e.abrupt("return",this._firestore);case 16:case"end":return e.stop()}}),e,this,[[2,9]])})));return function(t){return e.apply(this,arguments)}}()},{key:"getAuth",value:function(){var e=Object($.a)(Q.a.mark((function e(){return Q.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this._auth){e.next=2;break}return e.abrupt("return",this._auth);case 2:if(!this._authPromise){e.next=4;break}return e.abrupt("return",this._authPromise);case 4:return this._authPromise=this.getAuthPromise(),e.next=7,this._authPromise;case 7:return this._auth=e.sent,this._auth.subscribe(this.onAuth),this._authPromise=void 0,e.abrupt("return",this._auth);case 11:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getAuthPromise",value:function(){var e=Object($.a)(Q.a.mark((function e(){var t;return Q.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([n.e(3),n.e(30),n.e(33)]).then(n.bind(null,268));case 2:return t=e.sent,e.abrupt("return",new t.AuthApiImpl);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"getBudgetsStore",value:function(){var e=Object($.a)(Q.a.mark((function e(){var t;return Q.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this._budgetsStore){e.next=5;break}return e.next=3,n.e(22).then(n.bind(null,269));case 3:t=e.sent,this._budgetsStore=new t.BudgetsStoreImpl(this);case 5:return e.abrupt("return",this._budgetsStore);case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getCategoriesStore",value:function(){var e=Object($.a)(Q.a.mark((function e(){var t;return Q.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this._categoriesStore){e.next=5;break}return e.next=3,n.e(31).then(n.bind(null,270));case 3:t=e.sent,this._categoriesStore=new t.CategoriesStoreImpl(this.storage);case 5:return e.abrupt("return",this._categoriesStore);case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getIconsStore",value:function(){var e=Object($.a)(Q.a.mark((function e(){var t;return Q.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this._iconsStore){e.next=5;break}return e.next=3,n.e(32).then(n.bind(null,323));case 3:t=e.sent,this._iconsStore=new t.IconsStoreImpl;case 5:return e.abrupt("return",this._iconsStore);case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getCurrenciesStore",value:function(){var e=Object($.a)(Q.a.mark((function e(){var t,r,a,s;return Q.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this._currenciesStore){e.next=8;break}return e.next=3,Promise.all([n.e(80).then(n.t.bind(null,271,3)),n.e(26).then(n.bind(null,326))]);case 3:t=e.sent,r=Object(o.a)(t,2),a=r[0],s=r[1],this._currenciesStore=new s.CurrenciesStoreImpl(a.default);case 8:return e.abrupt("return",this._currenciesStore);case 9:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getCountriesStore",value:function(){var e=Object($.a)(Q.a.mark((function e(){var t;return Q.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this._countriesStore){e.next=9;break}return e.next=3,n.e(29).then(n.bind(null,327));case 3:return t=e.sent,e.t0=t.CountriesStoreImpl,e.next=7,n.e(78).then(n.t.bind(null,272,3));case 7:e.t1=e.sent,this._countriesStore=new e.t0(e.t1);case 9:return e.abrupt("return",this._countriesStore);case 10:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),e}());i.a.render(c.a.createElement(G,{btApp:oe}),document.getElementById("root")),function(e){if("serviceWorker"in navigator){if(new URL("/budget-tracker",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",(function(){var t="".concat("/budget-tracker","/service-worker.js");r?(!function(e,t){fetch(e).then((function(n){var r=n.headers.get("content-type");404===n.status||null!=r&&-1===r.indexOf("javascript")?navigator.serviceWorker.ready.then((function(e){e.unregister().then((function(){window.location.reload()}))})):a(e,t)})).catch((function(){console.log("No internet connection found. App is running in offline mode.")}))}(t,e),navigator.serviceWorker.ready.then((function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://bit.ly/CRA-PWA")}))):a(t,e)}))}}()}},[[81,6,7]]]);
//# sourceMappingURL=main.cb6ff441.chunk.js.map