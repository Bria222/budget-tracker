(this["webpackJsonpbudget-tracker"]=this["webpackJsonpbudget-tracker"]||[]).push([[7],{113:function(t,r,e){"use strict";e.d(r,"a",(function(){return i}));var n=e(2),u=e.n(n),a=e(3),o=e(13),c=e(14),i=function(){function t(r){Object(o.a)(this,t),this.baseUrl=void 0,this.baseUrl=r}return Object(c.a)(t,[{key:"getUrl",value:function(t,r){var e=new URL("".concat(this.baseUrl,"/").concat(t));return Object.keys(r).forEach((function(t){return e.searchParams.append(t,r[t])})),e.toString()}},{key:"fetch",value:function(t){function r(r,e){return t.apply(this,arguments)}return r.toString=function(){return t.toString()},r}(function(){var t=Object(a.a)(u.a.mark((function t(r,e){var n;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,fetch(r,e);case 2:if(!(n=t.sent).ok){t.next=5;break}return t.abrupt("return",n.json());case 5:throw new Error("Error fetching ".concat(r," > ").concat(n.status));case 6:case"end":return t.stop()}}),t)})));return function(r,e){return t.apply(this,arguments)}}())},{key:"get",value:function(){var t=Object(a.a)(u.a.mark((function t(r,e){var n;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=this.getUrl(r,e),t.abrupt("return",this.fetch(n,{method:"GET"}));case 2:case"end":return t.stop()}}),t,this)})));return function(r,e){return t.apply(this,arguments)}}()}]),t}()},177:function(t,r,e){"use strict";e.r(r);var n=e(2),u=e.n(n),a=e(3),o=e(13),c=e(14),i=e(113),s=function(){function t(){Object(o.a)(this,t),this.api=new i.a("https://nominatim.openstreetmap.org")}return Object(c.a)(t,[{key:"getCurrentLocation",value:function(){var t=Object(a.a)(u.a.mark((function t(){return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!navigator.geolocation){t.next=2;break}return t.abrupt("return",new Promise((function(t,r){navigator.geolocation.getCurrentPosition(t,r)})));case 2:return t.abrupt("return",Promise.reject("Geolocation is not supported"));case 3:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}()},{key:"getCountry",value:function(){var t=Object(a.a)(u.a.mark((function t(r,e){var n;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n={format:"json",lon:e.toString(),lat:r.toString()},t.abrupt("return",this.api.get("reverse.php",n));case 2:case"end":return t.stop()}}),t,this)})));return function(r,e){return t.apply(this,arguments)}}()},{key:"getCurrentCountry",value:function(){var t=Object(a.a)(u.a.mark((function t(){var r,e;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.getCurrentLocation();case 2:return r=t.sent,t.next=5,this.getCountry(r.coords.latitude,r.coords.longitude);case 5:return e=t.sent,t.abrupt("return",e.address.country_code);case 7:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()}]),t}();e.d(r,"CountriesStoreImpl",(function(){return p}));var p=function(){function t(r){Object(o.a)(this,t),this.geoApi=void 0,this.currentCountry=void 0,this.LAST_COUNTRY_KEY="lastCountry",this.countries=void 0,this.countries=Object.values(r),this.geoApi=new s,this.currentCountry=this.getCachedCurrentCountry()}return Object(c.a)(t,[{key:"getCachedCurrentCountry",value:function(){var t=localStorage.getItem(this.LAST_COUNTRY_KEY);if(t)try{var r=JSON.parse(t);if(r.code)return r}catch(e){console.warn(e)}}},{key:"setCurrentCountry",value:function(t){this.currentCountry={code:t.toUpperCase(),timestamp:Date.now()},localStorage.setItem(this.LAST_COUNTRY_KEY,JSON.stringify(this.currentCountry))}},{key:"getCurrentCountry",value:function(){var t=Object(a.a)(u.a.mark((function t(){return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(this.currentCountry&&this.currentCountry.code&&this.currentCountry.timestamp&&Date.now()-this.currentCountry.timestamp<36e5)){t.next=2;break}return t.abrupt("return",this.currentCountry.code);case 2:return t.abrupt("return",this.fetchCurrentCountry());case 3:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"fetchCurrentCountry",value:function(){var t=Object(a.a)(u.a.mark((function t(){var r;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,this.geoApi.getCurrentCountry();case 3:if(!(r=t.sent)){t.next=7;break}return this.setCurrentCountry(r),t.abrupt("return",r.toUpperCase());case 7:t.next=12;break;case 9:t.prev=9,t.t0=t.catch(0),console.warn("Fetching current country error: ",t.t0);case 12:return t.abrupt("return",this.currentCountry&&this.currentCountry.code);case 13:case"end":return t.stop()}}),t,this,[[0,9]])})));return function(){return t.apply(this,arguments)}}()},{key:"currentCountryCode",get:function(){return this.currentCountry&&this.currentCountry.code}}]),t}()}}]);
//# sourceMappingURL=7.386773f5.chunk.js.map