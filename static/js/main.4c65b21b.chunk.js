(this["webpackJsonpbudget-tracker"]=this["webpackJsonpbudget-tracker"]||[]).push([[1],{54:function(e,t,r){e.exports=r(65)},65:function(e,t,r){"use strict";r.r(t);var n=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function a(e,t){navigator.serviceWorker.register(e).then((function(e){e.onupdatefound=function(){var r=e.installing;null!=r&&(r.onstatechange=function(){"installed"===r.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See https://bit.ly/CRA-PWA."),t&&t.onUpdate&&t.onUpdate(e)):(console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(e)))})}})).catch((function(e){console.error("Error during service worker registration:",e)}))}var s=r(15),i=r.n(s),o=r(0),c=r.n(o),u=r(2),l=r.n(u),p=r(3),h=r(10),f=r(95),d=r(96),v=r(30),b=function(e){return o.createElement(f.a,{position:"sticky"},o.createElement(d.a,null,o.createElement(v.a,{color:"inherit",variant:"h6",style:{flexGrow:1}},e.title),e.actions))},g=r(103),m=r(105),x=r(108),w=r(43),y=r.n(w),k=r(97),O=r(101),j=r(99),E=r(100),S=r(107),_=r(98),C=r(42),D=r.n(C),B=r(106),A=r(41),I=r.n(A),T=function(e){var t=c.a.useState(),r=Object(h.a)(t,2),n=r[0],a=r[1],s=e.type||"default",i="".concat(s,"-message-id");function o(){a(!0)}return c.a.createElement(B.a,{anchorOrigin:{vertical:"bottom",horizontal:"left"},open:!n,autoHideDuration:6e3,onClose:o,ContentProps:{"aria-describedby":i},message:c.a.createElement("span",{id:i},e.message),action:[c.a.createElement(S.a,{key:"close","aria-label":"Close",color:"inherit",onClick:o},c.a.createElement(I.a,null))]})},P=function(e){return c.a.createElement(T,Object.assign({type:"info"},e))},L=r(29),R=r.n(L),N=r(102);function F(e){return"".concat(e,"-").concat((new Date).toLocaleDateString(),".json")}var W=function(e){var t=o.useState(),r=Object(h.a)(t,2),n=r[0],a=r[1],s=o.useState(),i=Object(h.a)(s,2),c=i[0],u=i[1],f=e.loc,d=o.useMemo((function(){if(c){var e=new Blob([c],{type:"application/octet-stream"});return URL.createObjectURL(e)}return"#"}),[c]);function b(){return(b=Object(p.a)(l.a.mark((function e(){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:c&&(navigator.clipboard.writeText(c),a(f.get("Copied to clipboard")));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return o.useEffect((function(){u(JSON.stringify(e.dataToExport))}),[e.dataToExport]),o.createElement(k.a,null,o.createElement(_.a,{title:f.get("Migrate your data")}),n&&o.createElement(P,{message:n}),o.createElement(j.a,null,!c&&n&&o.createElement(v.a,{color:"error"},n),c&&o.createElement(U,{fileName:e.fileName,url:d,description:f.get("Download JSON file"),extra:f.get("Import it later from the other domain")})),c&&o.createElement(E.a,null,o.createElement(S.a,{color:"primary",disabled:!c,href:d,download:F(e.fileName)},o.createElement(D.a,null)),o.createElement(S.a,{disabled:!c,key:"export-copy-to-clipboard","aria-label":f.get("Copy JSON"),onClick:function(){return b.apply(this,arguments)}},o.createElement(y.a,null))))},U=function(e){return o.createElement(o.Fragment,null,o.createElement(v.a,{variant:"body1"},"1. ",e.description,": ",o.createElement(O.a,{href:e.url,download:F(e.fileName),variant:"body1"},"".concat(e.fileName,".json")),"."),o.createElement(N.a,{style:{marginTop:"2rem",marginBottom:"2rem"}}),o.createElement(v.a,{variant:"subtitle1"},"2. ",o.createElement(O.a,{href:"https://btapp.netlify.com/import-export",target:"_blank"},e.extra," ",o.createElement(R.a,{style:{width:"0.8rem",verticalAlign:"middle"}})),"."))},z=function(e){var t=c.a.useState(),r=Object(h.a)(t,2),n=r[0],a=r[1],s=e.btApp.localization;return c.a.useEffect((function(){function t(){return(t=Object(p.a)(l.a.mark((function t(){var r;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e.btApp.getBudgetsStore();case 3:return r=t.sent,t.t0=a,t.next=7,r.export();case 7:t.t1=t.sent,(0,t.t0)(t.t1),t.next=15;break;case 11:t.prev=11,t.t2=t.catch(0),console.warn("There is no data to export: ",t.t2),a(void 0);case 15:case"end":return t.stop()}}),t,null,[[0,11]])})))).apply(this,arguments)}!function(){t.apply(this,arguments)}()}),[e.btApp]),c.a.createElement(c.a.Fragment,null,c.a.createElement(x.a,null),c.a.createElement(b,{title:s.get("App moved"),actions:[]}),c.a.createElement("main",null,c.a.createElement(g.a,{maxWidth:"lg"},c.a.createElement(m.a,{mt:2,marginBottom:8},c.a.createElement(v.a,{variant:"subtitle1",color:"error"},s.get("App moved title"),": ",c.a.createElement(O.a,{href:"https://btapp.netlify.com",target:"_blank"},"btapp.netlify.com",c.a.createElement(R.a,{style:{width:"0.8rem",verticalAlign:"middle"}}))),n&&c.a.createElement(W,{loc:e.btApp.localization,dataToExport:n,fileName:"budget-tracker-exported-data"}),c.a.createElement(v.a,{variant:"subtitle1",color:"error"},s.get("App moved title"),": ",c.a.createElement(O.a,{href:"https://btapp.netlify.com",target:"_blank"},"btapp.netlify.com",c.a.createElement(R.a,{style:{width:"0.8rem",verticalAlign:"middle"}}))),"."))))},J=r(13),K=r(14),M=function(){function e(t,r){Object(J.a)(this,e),this.from=void 0,this.to=void 0,this.name=void 0,this.from=t,this.to=r,this.name="".concat(this.from.constructor.name," > ").concat(this.to.constructor.name)}return Object(K.a)(e,[{key:"sync",value:function(){var e=Object(p.a)(l.a.mark((function e(){var t;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.debug(this.name),e.next=3,this.from.export();case 3:if(!(t=e.sent)){e.next=6;break}return e.abrupt("return",this.to.import(t));case 6:console.info("Nothing to sync");case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),e}(),G=r(46),H=r.n(G);var $,q,Q=function(){function e(t){Object(J.a)(this,e),this.local=void 0,this.remote=void 0,this.observers=void 0,console.log("Instantiated",this),this.local=t,this.observers=new Set}return Object(K.a)(e,[{key:"addObserver",value:function(e){this.observers.add(e)}},{key:"deleteObserver",value:function(e){this.observers.delete(e)}},{key:"notifyObservers",value:function(){this.observers.forEach((function(e){return e.onStorageDataChanged()}))}},{key:"loadDeviceId",value:function(){var e=localStorage.getItem("deviceId");if(e)return e;console.debug("First time app starts, generating device ID");var t=H()();return localStorage.setItem("deviceId",t),t}},{key:"setRemote",value:function(){var e=Object(p.a)(l.a.mark((function e(t){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.remote===t){e.next=4;break}if(this.remote=t,!this.remote){e.next=4;break}return e.abrupt("return",this.sync());case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"sync",value:function(){var e=Object(p.a)(l.a.mark((function e(){var t,r,n,a;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.remote){e.next=21;break}return e.next=3,Promise.all([this.remote.getLastTimeSaved(),this.local.getLastTimeSaved()]);case 3:if(t=e.sent,r=Object(h.a)(t,2),n=r[0],a=r[1],!(n>a)){e.next=12;break}return e.next=10,new M(this.remote,this.local).sync();case 10:e.next=19;break;case 12:if(!(n<a)){e.next=17;break}return e.next=15,new M(this.local,this.remote).sync();case 15:e.next=19;break;case 17:return console.debug("Nothing to sync"),e.abrupt("return");case 19:this.notifyObservers(),console.debug("Sync done");case 21:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getBudget",value:function(){var e=Object(p.a)(l.a.mark((function e(t){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.local.getBudget(t));case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getBudgets",value:function(){var e=Object(p.a)(l.a.mark((function e(){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.local.getBudgets());case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getExpenses",value:function(){var e=Object(p.a)(l.a.mark((function e(t){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.local.getExpenses(t));case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"setBudget",value:function(){var e=Object(p.a)(l.a.mark((function e(t){var r,n,a=arguments;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=a.length>1&&void 0!==a[1]?a[1]:Date.now(),n=this.local.setBudget(t,r),this.remote&&this.remote.setBudget(t,r),e.abrupt("return",n);case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"deleteBudget",value:function(){var e=Object(p.a)(l.a.mark((function e(t){var r,n,a=arguments;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=a.length>1&&void 0!==a[1]?a[1]:Date.now(),n=this.local.deleteBudget(t,r),this.remote&&this.remote.deleteBudget(t,r),e.abrupt("return",n);case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getExpense",value:function(){var e=Object(p.a)(l.a.mark((function e(t){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.local.getExpense(t));case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"setExpenses",value:function(){var e=Object(p.a)(l.a.mark((function e(t){var r,n,a=arguments;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=a.length>1&&void 0!==a[1]?a[1]:Date.now(),n=this.local.setExpenses(t,r),this.remote&&this.remote.setExpenses(t,r),e.abrupt("return",n);case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"deleteExpense",value:function(){var e=Object(p.a)(l.a.mark((function e(t){var r,n,a=arguments;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=a.length>1&&void 0!==a[1]?a[1]:Date.now(),n=this.local.deleteExpense(t,r),this.remote&&this.remote.deleteExpense(t,r),e.abrupt("return",n);case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getCategory",value:function(){var e=Object(p.a)(l.a.mark((function e(t){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.local.getCategory(t));case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getCategories",value:function(){var e=Object(p.a)(l.a.mark((function e(){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.local.getCategories());case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"setCategories",value:function(){var e=Object(p.a)(l.a.mark((function e(t){var r,n,a=arguments;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=a.length>1&&void 0!==a[1]?a[1]:Date.now(),n=this.local.setCategories(t,r),this.remote&&this.remote.setCategories(t,r),e.abrupt("return",n);case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"deleteCategory",value:function(){var e=Object(p.a)(l.a.mark((function e(t){var r,n,a=arguments;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=a.length>1&&void 0!==a[1]?a[1]:Date.now(),n=this.local.deleteCategory(t,r),this.remote&&this.remote.deleteCategory(t,r),e.abrupt("return",n);case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),e}(),V=r(26),X=r(47);function Y(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Z(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Y(r,!0).forEach((function(t){Object(V.a)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Y(r).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}!function(e){e.RemoteToLocal="RemoteToLocal",e.LocalToRemote="LocalToRemote"}($||($={})),function(e){e.Budgets="budgets",e.Expenses="expenses",e.Categories="categories"}(q||(q={}));var ee,te={keyPath:"identifier"},re=function(){function e(){Object(J.a)(this,e),this.name="budgetTrackerDb",this.version=1,this._db=void 0}return Object(K.a)(e,[{key:"createDb",value:function(){var e=Object(p.a)(l.a.mark((function e(){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Object(X.a)(this.name,this.version,{upgrade:function(e){e.createObjectStore(q.Budgets,te).createIndex("deleted, to",["deleted","to"]),e.createObjectStore(q.Categories,te).createIndex("deleted, name",["deleted","name"]),e.createObjectStore(q.Expenses,te).createIndex("deleted, budgetId, when",["deleted","budgetId","when"])}}));case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"enablePersistentStorage",value:function(){var e=Object(p.a)(l.a.mark((function e(){var t,r;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=navigator,r=t.storage,e.t0=r&&r.persist,!e.t0){e.next=6;break}return e.next=5,r.persist();case 5:e.t0=e.sent;case 6:e.t0?console.info("Storage will not be cleared except by explicit user action"):console.warn("Storage may be cleared by the UA under storage pressure.");case 8:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"getDb",value:function(){var e=Object(p.a)(l.a.mark((function e(){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0!==this._db){e.next=6;break}return e.next=3,this.enablePersistentStorage();case 3:return e.next=5,this.createDb();case 5:this._db=e.sent;case 6:return e.abrupt("return",this._db);case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getBudgets",value:function(){var e=Object(p.a)(l.a.mark((function e(){var t,r,n,a;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getDb();case 2:return t=e.sent,r=IDBKeyRange.upperBound([1,0]),e.next=6,t.getAllFromIndex(q.Budgets,"deleted, to",r);case 6:return n=e.sent,a={},n.forEach((function(e){return a[e.identifier]=e})),e.abrupt("return",a);case 10:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getBudget",value:function(){var e=Object(p.a)(l.a.mark((function e(t){var r;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getDb();case 2:return r=e.sent,e.abrupt("return",r.get(q.Budgets,t));case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"setBudget",value:function(){var e=Object(p.a)(l.a.mark((function e(t,r){var n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getDb();case 2:return n=e.sent,e.next=5,n.put(q.Budgets,Z({deleted:0,timestamp:r},t));case 5:return e.abrupt("return",this.setLastTimeSaved(r));case 6:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"deleteBudget",value:function(){var e=Object(p.a)(l.a.mark((function e(t){var r,n,a,s,i=arguments;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=i.length>1&&void 0!==i[1]?i[1]:Date.now(),e.next=3,this.getDb();case 3:return n=e.sent,a=n.transaction(q.Budgets,"readwrite"),e.next=7,a.store.get(t);case 7:return(s=e.sent)&&a.store.put(Z({},s,{deleted:1,timestamp:r})),e.next=11,a.done;case 11:this.setLastTimeSaved(r);case 12:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getExpenses",value:function(){var e=Object(p.a)(l.a.mark((function e(t){var r,n,a,s,i;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getDb();case 2:return r=e.sent,e.next=5,r.get(q.Budgets,t);case 5:if(!(n=e.sent)){e.next=14;break}return a=IDBKeyRange.bound([0,t,n.from],[0,t,n.to]),e.next=10,r.getAllFromIndex(q.Expenses,"deleted, budgetId, when",a);case 10:return s=e.sent,i={},s.forEach((function(e){return i[e.identifier]=e})),e.abrupt("return",i);case 14:throw new Error("There is no budget with id "+t);case 15:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getAllExpenses",value:function(){var e=Object(p.a)(l.a.mark((function e(){var t,r,n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getDb();case 2:return t=e.sent,e.next=5,t.getAll(q.Expenses);case 5:return r=e.sent,n={},r.forEach((function(e){return n[e.identifier]=e})),e.abrupt("return",n);case 9:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getExpense",value:function(){var e=Object(p.a)(l.a.mark((function e(t){var r;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getDb();case 2:return r=e.sent,e.abrupt("return",r.get(q.Expenses,t));case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"setExpenses",value:function(){var e=Object(p.a)(l.a.mark((function e(t,r){var n,a,s,i,o,c,u,p;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getDb();case 2:for(n=e.sent,a=n.transaction(q.Expenses,"readwrite"),s=!0,i=!1,o=void 0,e.prev=7,c=t[Symbol.iterator]();!(s=(u=c.next()).done);s=!0)p=u.value,a.store.put(Z({},p,{timestamp:r,deleted:0}));e.next=15;break;case 11:e.prev=11,e.t0=e.catch(7),i=!0,o=e.t0;case 15:e.prev=15,e.prev=16,s||null==c.return||c.return();case 18:if(e.prev=18,!i){e.next=21;break}throw o;case 21:return e.finish(18);case 22:return e.finish(15);case 23:return e.next=25,a.done;case 25:return e.abrupt("return",this.setLastTimeSaved(r));case 26:case"end":return e.stop()}}),e,this,[[7,11,15,23],[16,,18,22]])})));return function(t,r){return e.apply(this,arguments)}}()},{key:"deleteExpense",value:function(){var e=Object(p.a)(l.a.mark((function e(t,r){var n,a,s;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getDb();case 2:return n=e.sent,a=n.transaction(q.Expenses,"readwrite"),e.next=6,a.store.get(t);case 6:return(s=e.sent)&&a.store.put(Z({},s,{deleted:1,timestamp:r})),e.next=10,a.done;case 10:return e.abrupt("return",this.setLastTimeSaved(r));case 11:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"getCategories",value:function(){var e=Object(p.a)(l.a.mark((function e(){var t,r,n,a;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getDb();case 2:return t=e.sent,r=IDBKeyRange.upperBound([1],!0),e.next=6,t.getAllFromIndex(q.Categories,"deleted, name",r);case 6:return n=e.sent,a={},n&&n.forEach((function(e){return a[e.identifier]=e})),e.abrupt("return",a);case 10:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"setCategories",value:function(){var e=Object(p.a)(l.a.mark((function e(t,r){var n,a,s,i,o,c,u,p;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getDb();case 2:for(n=e.sent,a=n.transaction(q.Categories,"readwrite"),s=!0,i=!1,o=void 0,e.prev=7,c=t[Symbol.iterator]();!(s=(u=c.next()).done);s=!0)p=u.value,a.store.put(Z({},p,{timestamp:r,deleted:0}));e.next=15;break;case 11:e.prev=11,e.t0=e.catch(7),i=!0,o=e.t0;case 15:e.prev=15,e.prev=16,s||null==c.return||c.return();case 18:if(e.prev=18,!i){e.next=21;break}throw o;case 21:return e.finish(18);case 22:return e.finish(15);case 23:return e.next=25,a.done;case 25:return e.abrupt("return",this.setLastTimeSaved(r));case 26:case"end":return e.stop()}}),e,this,[[7,11,15,23],[16,,18,22]])})));return function(t,r){return e.apply(this,arguments)}}()},{key:"getCategory",value:function(){var e=Object(p.a)(l.a.mark((function e(t){var r;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getDb();case 2:return r=e.sent,e.abrupt("return",r.get(q.Categories,t));case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"deleteCategory",value:function(){var e=Object(p.a)(l.a.mark((function e(t,r){var n,a,s;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getDb();case 2:return n=e.sent,a=n.transaction(q.Categories,"readwrite"),e.next=6,a.store.get(t);case 6:return(s=e.sent)&&a.objectStore(q.Categories).put(Z({},s,{timestamp:r,deleted:1})),e.next=10,a.done;case 10:return e.abrupt("return",this.setLastTimeSaved(r));case 11:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"import",value:function(){var e=Object(p.a)(l.a.mark((function e(t){var r,n,a,s,i,o;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getDb();case 2:for(s in r=e.sent,n=r.transaction([q.Budgets,q.Categories,q.Expenses],"readwrite"),a={deleted:0,timestamp:t.lastTimeSaved},t.budgets)n.objectStore(q.Budgets).put(Z({},a,{},t.budgets[s]));for(i in t.expenses)n.objectStore(q.Expenses).put(Z({},a,{},t.expenses[i]));for(o in t.categories)n.objectStore(q.Categories).put(Z({},a,{},t.categories[o]));return e.next=10,n.done;case 10:return e.abrupt("return",this.setLastTimeSaved(t.lastTimeSaved));case 11:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"export",value:function(){var e=Object(p.a)(l.a.mark((function e(){var t,r,n,a,s,i;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([this.getBudgets(),this.getCategories(),this.getAllExpenses(),this.getLastTimeSaved()]);case 2:return t=e.sent,r=Object(h.a)(t,4),n=r[0],a=r[1],s=r[2],i=r[3],e.abrupt("return",{budgets:n,expenses:s,categories:a,lastTimeSaved:i});case 9:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getLastTimeSaved",value:function(){var e=Object(p.a)(l.a.mark((function e(){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",parseInt(localStorage.getItem("timestamp")||"0"));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"setLastTimeSaved",value:function(){var e=Object(p.a)(l.a.mark((function e(t){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:localStorage.setItem("timestamp",t.toString());case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}]),e}(),ne="en",ae=(ee={},Object(V.a)(ee,ne,r.e(58).then(r.t.bind(null,129,3))),Object(V.a)(ee,"es",r.e(59).then(r.t.bind(null,130,3))),ee),se=function(){function e(t){Object(J.a)(this,e),this.lang=void 0,this.strings=void 0,t=t.slice(0,2),this.lang=t in ae?t:ne,this.strings={},this.initStrings()}return Object(K.a)(e,[{key:"initStrings",value:function(){var e=Object(p.a)(l.a.mark((function e(){var t,r=this;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ae[this.lang];case 2:t=e.sent.default,Object.entries(t).forEach((function(e){var t=Object(h.a)(e,2),n=t[0],a=t[1];return r.strings[n]=a}));case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"get",value:function(e){return this.strings[e]||e}}]),e}(),ie=new(function(){function e(){var t=this;Object(J.a)(this,e),this.storage=void 0,this.localization=void 0,this._firestore=void 0,this._auth=void 0,this._authPromise=void 0,this._budgetsStore=void 0,this._categoriesStore=void 0,this._iconsStore=void 0,this._currenciesStore=void 0,this._countriesStore=void 0,this.onAuth=function(){var e=Object(p.a)(l.a.mark((function e(r){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=t.storage,e.next=3,t.initFirestore(r);case 3:e.t1=e.sent,e.t0.setRemote.call(e.t0,e.t1);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.initBgAuth(),this.storage=new Q(new re),this.localization=new se(navigator.language)}return Object(K.a)(e,[{key:"initBgAuth",value:function(){var e=Object(p.a)(l.a.mark((function e(){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.debug("Fetching auth info..."),e.t0=console,e.next=4,this.getAuth();case 4:return e.next=6,e.sent.getUserId();case 6:e.t1=e.sent,e.t0.debug.call(e.t0,"Auth: ",e.t1);case 8:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"initFirestore",value:function(){var e=Object(p.a)(l.a.mark((function e(t){var n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t){e.next=14;break}if(this._firestore){e.next=12;break}return e.prev=2,e.next=5,Promise.all([r.e(0),r.e(4),r.e(12)]).then(r.bind(null,124));case 5:n=e.sent,this._firestore=new n.FirestoreApi(t,!0),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(2),console.warn("Cannot get user ID: ",e.t0);case 12:e.next=15;break;case 14:this._firestore=void 0;case 15:return e.abrupt("return",this._firestore);case 16:case"end":return e.stop()}}),e,this,[[2,9]])})));return function(t){return e.apply(this,arguments)}}()},{key:"getAuth",value:function(){var e=Object(p.a)(l.a.mark((function e(){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this._auth){e.next=2;break}return e.abrupt("return",this._auth);case 2:if(!this._authPromise){e.next=4;break}return e.abrupt("return",this._authPromise);case 4:return this._authPromise=this.getAuthPromise(),e.next=7,this._authPromise;case 7:return this._auth=e.sent,this._auth.subscribe(this.onAuth),this._authPromise=void 0,e.abrupt("return",this._auth);case 11:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getAuthPromise",value:function(){var e=Object(p.a)(l.a.mark((function e(){var t;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([r.e(0),r.e(8),r.e(11)]).then(r.bind(null,125));case 2:return t=e.sent,e.abrupt("return",new t.AuthApiImpl);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"getBudgetsStore",value:function(){var e=Object(p.a)(l.a.mark((function e(){var t;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this._budgetsStore){e.next=5;break}return e.next=3,r.e(6).then(r.bind(null,174));case 3:t=e.sent,this._budgetsStore=new t.BudgetsStoreImpl(this);case 5:return e.abrupt("return",this._budgetsStore);case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getCategoriesStore",value:function(){var e=Object(p.a)(l.a.mark((function e(){var t;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this._categoriesStore){e.next=5;break}return e.next=3,r.e(9).then(r.bind(null,126));case 3:t=e.sent,this._categoriesStore=new t.CategoriesStoreImpl(this.storage);case 5:return e.abrupt("return",this._categoriesStore);case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getIconsStore",value:function(){var e=Object(p.a)(l.a.mark((function e(){var t;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this._iconsStore){e.next=5;break}return e.next=3,r.e(10).then(r.bind(null,175));case 3:t=e.sent,this._iconsStore=new t.IconsStoreImpl;case 5:return e.abrupt("return",this._iconsStore);case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getCurrenciesStore",value:function(){var e=Object(p.a)(l.a.mark((function e(){var t,n,a,s;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this._currenciesStore){e.next=8;break}return e.next=3,Promise.all([r.e(57).then(r.t.bind(null,127,3)),r.e(5).then(r.bind(null,176))]);case 3:t=e.sent,n=Object(h.a)(t,2),a=n[0],s=n[1],this._currenciesStore=new s.CurrenciesStoreImpl(a.default);case 8:return e.abrupt("return",this._currenciesStore);case 9:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getCountriesStore",value:function(){var e=Object(p.a)(l.a.mark((function e(){var t;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this._countriesStore){e.next=9;break}return e.next=3,r.e(7).then(r.bind(null,177));case 3:return t=e.sent,e.t0=t.CountriesStoreImpl,e.next=7,r.e(55).then(r.t.bind(null,128,3));case 7:e.t1=e.sent,this._countriesStore=new e.t0(e.t1);case 9:return e.abrupt("return",this._countriesStore);case 10:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),e}());i.a.render(c.a.createElement(z,{btApp:ie}),document.getElementById("root")),function(e){if("serviceWorker"in navigator){if(new URL("/budget-tracker",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",(function(){var t="".concat("/budget-tracker","/service-worker.js");n?(!function(e,t){fetch(e).then((function(r){var n=r.headers.get("content-type");404===r.status||null!=n&&-1===n.indexOf("javascript")?navigator.serviceWorker.ready.then((function(e){e.unregister().then((function(){window.location.reload()}))})):a(e,t)})).catch((function(){console.log("No internet connection found. App is running in offline mode.")}))}(t,e),navigator.serviceWorker.ready.then((function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://bit.ly/CRA-PWA")}))):a(t,e)}))}}()}},[[54,2,3]]]);
//# sourceMappingURL=main.4c65b21b.chunk.js.map