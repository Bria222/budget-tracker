(this["webpackJsonpbudget-tracker"]=this["webpackJsonpbudget-tracker"]||[]).push([[11],{140:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(0);function a(e,t,n){Object(r.useEffect)((function(){return n.onTitleChange(e),n.onActions(t),function(){n.onTitleChange(""),n.onActions(void 0)}}),[])}},141:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var r=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"/";e.length>2?e.goBack():e.replace(t)}},143:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(14),a=n(18),i=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Date;Object(r.a)(this,e),this._date=void 0,this._date=new Date(t.getFullYear(),t.getMonth(),t.getDate())}return Object(a.a)(e,[{key:"clone",value:function(){return new e(this._date)}},{key:"addDays",value:function(e){return this._date.setDate(this._date.getDate()+e),this}},{key:"addMonths",value:function(e){return this._date.setMonth(this._date.getMonth()+e),this}},{key:"addYears",value:function(e){return this._date.setFullYear(this._date.getFullYear()+e),this}},{key:"equals",value:function(e){return this._date.getTime()===e._date.getTime()}},{key:"year",get:function(){return this._date.getFullYear()}},{key:"month",get:function(){return this._date.getMonth()}},{key:"day",get:function(){return this._date.getDate()}},{key:"timeMs",get:function(){return this._date.getTime()}},{key:"isToday",get:function(){return e.isToday(this)}},{key:"shortString",get:function(){return new Intl.DateTimeFormat(void 0,{day:"numeric",month:"long",year:"numeric"}).format(this._date)}}],[{key:"fromTimeMs",value:function(t){return new e(new Date(t))}},{key:"fromYMD",value:function(t){return new e(new Date(t.year,t.month,t.day))}},{key:"isToday",value:function(e){var t=new Date;return e.day===t.getDate()&&e.month===t.getMonth()&&e.year===t.getFullYear()}}]),e}()},144:function(e,t,n){"use strict";n.d(t,"a",(function(){return u})),n.d(t,"b",(function(){return c}));var r=n(0),a=n(52),i=n.n(a),s=n(141),o=n(94),u=function(e){return r.createElement(o.a,Object.assign({color:"inherit","aria-label":"Close"},e,{onClick:e.onClick}),r.createElement(i.a,null))},c=function(e){return r.createElement(u,{onClick:function(){Object(s.a)(e.history,e.to)}})}},146:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(2),a=n.n(r),i=n(4),s=n(16),o=n(0),u=n(40);function c(){var e=Object(o.useState)(),t=Object(s.a)(e,2),n=t[0],r=t[1],c=Object(u.b)();return Object(o.useEffect)((function(){function e(){return(e=Object(i.a)(a.a.mark((function e(){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=r,e.next=3,c.getBudgetsStore();case 3:e.t1=e.sent,(0,e.t0)(e.t1);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var t=!0;return t&&function(){e.apply(this,arguments)}(),function(){t=!1}}),[n,c]),Object(o.useEffect)((function(){var e=!0,t={onStorageDataChanged:function(){r(void 0)}};return e&&c.storage.addObserver(t),function(){e=!1,c.storage.deleteObserver(t)}}),[c]),n}},150:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return s})),n.d(t,"d",(function(){return o}));var r=864e5;function a(e,t){return Math.floor((t-e)/r)+1}function i(){return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Date).toISOString().slice(0,10)}function s(e){return new Intl.DateTimeFormat(void 0,{month:"long"}).format(new Date(2e3,e,1))}function o(e,t){return new Intl.DateTimeFormat(void 0,{month:"long",year:"numeric"}).format(new Date(e,t,1))}},152:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(2),a=n.n(r),i=n(4),s=n(16),o=n(0),u=n(40);function c(){var e=Object(u.b)(),t=Object(o.useState)(),n=Object(s.a)(t,2),r=n[0],c=n[1];return Object(o.useEffect)((function(){function t(){return(t=Object(i.a)(a.a.mark((function t(){return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.t0=c,t.next=3,e.getCategoriesStore();case 3:t.t1=t.sent,(0,t.t0)(t.t1);case 5:case"end":return t.stop()}}),t)})))).apply(this,arguments)}var n=!0;return n&&function(){t.apply(this,arguments)}(),function(){n=!1}}),[e,r]),r}},153:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(14),a=n(18),i=function(){function e(){Object(r.a)(this,e),this._total=void 0,this._subTotals=void 0,this._total=0,this._subTotals={}}return Object(a.a)(e,[{key:"add",value:function(e,t){this._total+=e;var n=this._getSubTotal(t);return n&&n.add(e,t),this._total}},{key:"subtract",value:function(e,t){return this.add(-e,t)}},{key:"_getSubTotal",value:function(t){if(void 0!==t){var n=t.shift();if(void 0!==n)return n in this._subTotals||(this._subTotals[n]=new e),this._subTotals[n]}}},{key:"getSubtotal",value:function(e){var t=e.shift();return void 0!==t?t in this._subTotals?this._subTotals[t].getSubtotal(e):0:this.total}},{key:"getAverage",value:function(e){var t=e.shift();return void 0!==t?t in this._subTotals?this._subTotals[t].getAverage(e):0:this.avg}},{key:"total",get:function(){return this._total}},{key:"avg",get:function(){return this._total/Object.keys(this._subTotals).length}},{key:"indexes",get:function(){return Object.keys(this._subTotals)}}]),e}()},165:function(e,t,n){"use strict";function r(e,t){return e/t}n.d(t,"a",(function(){return r}))},166:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(2),a=n.n(r),i=n(4),s=n(16),o=n(0),u=n(152);function c(){var e=Object(o.useState)(),t=Object(s.a)(e,2),n=t[0],r=t[1],c=Object(u.a)();return Object(o.useEffect)((function(){function e(){return(e=Object(i.a)(a.a.mark((function e(t){var n;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.getCategories();case 2:n=e.sent,r(n);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}c&&function(t){e.apply(this,arguments)}(c)}),[c]),n}},170:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(0),a=n(216),i=n(197),s=n(133);function o(e,t){return t?e/t*100:0}var u=function(e){return r.createElement(s.a,{variant:"body2",noWrap:!0},e.text,e.secondary&&r.createElement(s.a,{variant:"caption",color:"textSecondary"},e.secondary))},c=function(e){var t=e.spent,n=e.total,s=e.title,c=t>n;return r.createElement(r.Fragment,null,r.createElement(i.a,{container:!0,justify:"space-between",direction:"row"},r.createElement(u,{text:Math.round(t)}),r.createElement(u,{text:s,secondary:" (".concat(Math.round(n),")")}),r.createElement(u,{text:Math.round(n-t)})),r.createElement(a.a,{color:c?"secondary":"primary",variant:"determinate",value:c?100:o(t,n)}))}},182:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(36),a=n(14),i=n(18),s=n(143);function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function u(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(n,!0).forEach((function(t){Object(r.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var c=function(){function e(t){Object(a.a)(this,e),this._date=void 0,this.amount=void 0,this.amountBaseCurrency=void 0,this.currency=void 0,this.categoryId=void 0,this.countryCode=void 0,this.description=void 0,this.identifier=void 0,this.when=void 0,this.budgetId=void 0,this.splitInDays=void 0,this.identifier=t.identifier,this.amountBaseCurrency=t.amountBaseCurrency,this.amount=t.amount,this.currency=t.currency,this.categoryId=t.categoryId,this.countryCode=t.countryCode,this.description=t.description,this.when=t.when,this.budgetId=t.budgetId,this.splitInDays=t.splitInDays>0?t.splitInDays:1,this.validate()}return Object(i.a)(e,[{key:"inBudgetDates",value:function(e){return this.when<=e.to&&this.when>=e.from}},{key:"inDates",value:function(e,t){return this.when<=t&&this.when>=e}},{key:"addToTotals",value:function(e){var t=!0,n=!1,r=void 0;try{for(var a,i=this.split()[Symbol.iterator]();!(t=(a=i.next()).done);t=!0){var s=a.value;e.add(s.amountBaseCurrency,s.dateParts)}}catch(o){n=!0,r=o}finally{try{t||null==i.return||i.return()}finally{if(n)throw r}}}},{key:"subtractTotal",value:function(e){var t=!0,n=!1,r=void 0;try{for(var a,i=this.split()[Symbol.iterator]();!(t=(a=i.next()).done);t=!0){var s=a.value;e.subtract(s.amountBaseCurrency,s.dateParts)}}catch(o){n=!0,r=o}finally{try{t||null==i.return||i.return()}finally{if(n)throw r}}}},{key:"validate",value:function(){var e=[];if(void 0===this.budgetId&&e.push("budget identifier"),void 0===this.amountBaseCurrency&&e.push("amount in base currency"),2!==this.countryCode.length&&e.push("country code"),3!==this.currency.length&&e.push("currency code"),e.length>0)throw Error("Invalid expense (".concat(this.identifier,") fields: ").concat(e.join(", ")))}},{key:"split",value:function(){if(this.splitInDays<1)throw Error("You cannot split an expense in less than one piece");if(1===this.splitInDays)return[this];for(var t=this.amountBaseCurrency/this.splitInDays,n=this.amount/this.splitInDays,r=[new e(u({},this,{amount:n,amountBaseCurrency:t}))],a=1;a<this.splitInDays;a++)r.push(new e(u({},this,{amount:n,amountBaseCurrency:t,when:s.a.fromTimeMs(this.when).addDays(a).timeMs})));return r}},{key:"info",get:function(){var e=this.amount,t=this.amountBaseCurrency,n=this.categoryId,r=this.countryCode,a=this.currency;return{amount:e,amountBaseCurrency:t,categoryId:n,description:this.description,identifier:this.identifier,when:this.when,countryCode:r,currency:a,budgetId:this.budgetId,splitInDays:this.splitInDays}}},{key:"json",get:function(){return JSON.stringify(this.info)}},{key:"date",get:function(){return this._date||(this._date=s.a.fromTimeMs(this.when)),this._date}},{key:"day",get:function(){return this.date.day}},{key:"month",get:function(){return this.date.month}},{key:"year",get:function(){return this.date.year}},{key:"dateParts",get:function(){return[this.year,this.month,this.day]}}],[{key:"sum",value:function(e){return Object.values(e).map((function(e){return e.amountBaseCurrency})).reduce((function(e,t){return e+t}))}}]),e}()},196:function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var r=n(0),a=n(41),i=n(170),s=n(178),o=n(171),u=n(172),c=n(198),l=n(136),f=n(51),d=function(e){var t=Object(f.a)();return r.createElement(o.a,{style:{marginBottom:"1rem"}},r.createElement(u.a,null,r.createElement(i.a,{total:e.totalBudget,spent:e.totalSpent,title:t("Spent")}),r.createElement(l.a,{marginTop:"0.5rem"},r.createElement(i.a,{total:e.totalDays,spent:e.passedDays,title:t("Days")})),void 0!==e.dailyAverage&&r.createElement(l.a,{marginTop:"0.5rem"},r.createElement(i.a,{total:e.expectedDailyAverage,spent:e.dailyAverage,title:t("Daily Average")}))),e.urlStats&&r.createElement(s.a,null,r.createElement(c.a,{size:"small",component:a.b,color:"primary",to:e.urlStats},t("More Stats"))))}},210:function(e,t,n){"use strict";var r=n(0),a=n.n(r),i=n(134),s=n(153);var o=n(175),u=function(e){return r.createElement(o.a,{type:"percentage",title:e.title,onDataSelect:function(t){e.onSelect&&e.onSelect(t.label)},maxSlices:e.maxSlices||8,data:{labels:e.labels,datasets:[{values:e.values}]}})},c=n(51);var l=function(e){var t=Object(c.a)(),n=e.budget,a=e.categories,o=r.useMemo((function(){if(a&&Object.keys(a).length>0){var e=[],t=[],r=function(e){var t=new s.a,n=!0,r=!1,a=void 0;try{for(var i,o=e.expenses[Symbol.iterator]();!(n=(i=o.next()).done);n=!0){var u=i.value;t.add(u.amountBaseCurrency,[u.categoryId])}}catch(c){r=!0,a=c}finally{try{n||null==o.return||o.return()}finally{if(r)throw a}}return t}(n);return r.indexes.forEach((function(n){e.push(function(e,t){return t[e]?t[e].name:e}(n,a)),t.push(Math.round(r.getSubtotal([n])))})),{labels:e,values:t}}}),[n,a]);return o?r.createElement(u,Object.assign({title:t("By category")},o,{onSelect:function(e){console.log(e)}})):r.createElement(i.a,null)},f=n(143);var d=function(e){var t=e.budget,n=Object(c.a)(),a=r.useMemo((function(){var e=function(e){var t=new s.a,n=Math.min((new f.a).timeMs,e.to),r=!0,a=!1,i=void 0;try{for(var o,u=e.expenses[Symbol.iterator]();!(r=(o=u.next()).done);r=!0){var c=o.value;c.inDates(e.from,n)&&t.add(c.amountBaseCurrency,[c.countryCode])}}catch(l){a=!0,i=l}finally{try{r||null==u.return||u.return()}finally{if(a)throw i}}return t}(t),n=e.indexes,r=[],a=[];return n.forEach((function(t){r.push(t),a.push(Math.round(e.getSubtotal([t])))})),{labels:r,values:a}}),[t]);return r.createElement(u,Object.assign({title:n("By country")},a))},h=function(e){return a.a.createElement(o.a,{title:e.title,lineOptions:{hideDots:1,areaFill:1,heatline:1,dotSize:0,hideLine:0,regionFill:1},type:"line",axisOptions:{xAxisMode:"tick",yAxisMode:"tick",xIsSeries:1},data:{labels:e.labels.map((function(e){return e.shortString})),datasets:[{values:e.values}]}})},y=function(e){var t=e.budget,n=Object(c.a)(),a=r.useMemo((function(){for(var e=t.from,n=t.to,r=Date.now(),a=[],i=[],s=new Date(e);s.getTime()<=n&&s.getTime()<=r;s.setDate(s.getDate()+1)){var o=new f.a(s),u=o.year,c=o.month,l=o.day,d=t.nestedTotalExpenses.getSubtotal([u,c,l]);a.push(new f.a(s)),i.push(Math.round(d))}return{labels:a,values:i}}),[t]);return r.createElement(h,Object.assign({title:n("By date")},a,{avg:t.average,expectedAvg:t.expectedDailyExpensesAverage}))},v=n(16);var p=function(e){var t=e.budget,n=Object(c.a)(),a=r.useMemo((function(){var e=function(e){var t={},n=e.expenseGroups,r=e.from,a=Date.now(),i=f.a.fromTimeMs(r),s=new Set;do{var o=n.getExpenses(i);o&&(s.clear(),o.forEach((function(e){return s.add(e.countryCode)})),s.forEach((function(e){return t[e]=(t[e]||0)+1}))),i.addDays(1)}while(i.timeMs<=a);return t}(t),n=[],r=[];return Object.entries(e).forEach((function(e){var t=Object(v.a)(e,2),a=t[0],i=t[1];n.push(a),r.push(Math.round(i))})),{labels:n,values:r}}),[t]);return r.createElement(u,Object.assign({title:n("Days in a country")},a))},m=n(197);var g=function(e){return a.a.createElement(o.a,{title:e.title,type:"bar",data:{labels:e.labels,datasets:[{values:e.values}]}})},b=function(e){var t=e.budget,n=Object(c.a)(),a=r.useMemo((function(){var e=function(e){var t=new s.a,n=Math.min((new f.a).timeMs,e.to),r=e.from,a=e.expenseGroups,i=!0,o=!1,u=void 0;try{for(var c,l=a[Symbol.iterator]();!(i=(c=l.next()).done);i=!0){var d=c.value,h=Object(v.a)(d,2),y=h[0],p=h[1],m=!0,g=!1,b=void 0;try{for(var x,E=p[Symbol.iterator]();!(m=(x=E.next()).done);m=!0){var k=x.value,_=Object(v.a)(k,2),w=_[0],O=_[1],j=!0,D=!1,T=void 0;try{for(var S,M=O[Symbol.iterator]();!(j=(S=M.next()).done);j=!0){var B=S.value,C=Object(v.a)(B,2),I=C[0],A=C[1],G=void 0,P=0,F=!0,Y=!1,z=void 0;try{for(var U,J=A.values()[Symbol.iterator]();!(F=(U=J.next()).done);F=!0){var q=U.value,L=q.countryCode,R=q.amountBaseCurrency;if(!q.inDates(r,n)||G&&G!==L){P=0;break}G=L,P+=R}}catch(V){Y=!0,z=V}finally{try{F||null==J.return||J.return()}finally{if(Y)throw z}}P&&G&&t.add(P,[G,f.a.fromYMD({year:y,month:w,day:I}).shortString])}}catch(V){D=!0,T=V}finally{try{j||null==M.return||M.return()}finally{if(D)throw T}}}}catch(V){g=!0,b=V}finally{try{m||null==E.return||E.return()}finally{if(g)throw b}}}}catch(V){o=!0,u=V}finally{try{i||null==l.return||l.return()}finally{if(o)throw u}}var N={};return t.indexes.forEach((function(e){return N[e]=t.getAverage([e])})),N}(t);return{labels:Object.keys(e),values:Object.values(e).map((function(e){return Math.round(e)}))}}),[t]);return a?r.createElement(g,Object.assign({title:n("Daily avg country")},a)):r.createElement(i.a,null)};n.d(t,"a",(function(){return x}));var x=function(e){var t=e.budget,n=e.categories;return r.createElement(m.a,{container:!0,spacing:3},r.createElement(m.a,{item:!0,xs:12,sm:6},n&&r.createElement(l,{budget:t,categories:n})),r.createElement(m.a,{item:!0,xs:12,sm:6},r.createElement(b,{budget:t})),r.createElement(m.a,{item:!0,xs:12,sm:6},r.createElement(d,{budget:t})),r.createElement(m.a,{item:!0,xs:12,sm:6},r.createElement(p,{budget:t})),r.createElement(m.a,{item:!0,xs:12,sm:12},r.createElement(y,{budget:t})))}},212:function(e,t,n){"use strict";var r=n(36),a=n(2),i=n.n(a),s=n(4),o=n(14),u=n(18),c=n(150),l=n(153),f=n(182),d=n(165),h=n(60),y=n(55),v=n(59),p=n(211),m=function(e){function t(){return Object(o.a)(this,t),Object(h.a)(this,Object(y.a)(t).apply(this,arguments))}return Object(v.a)(t,e),Object(u.a)(t,[{key:"addExpense",value:function(e){var t=e.year,n=this.get(t);void 0===n&&(n=new g,this.set(t,n)),n.addExpense(e)}},{key:"deleteExpense",value:function(e){var t=e.year,n=this.get(t);return!(!n||!n.deleteExpense(e))&&(0===n.size&&this.delete(t),!0)}},{key:"getExpenses",value:function(e){var t=e.year,n=e.month,r=e.day,a=this.get(t);if(a){var i=a.get(n);if(i)return i.get(r)}}},{key:"getAllGroupedByDate",value:function(e,n,r){var a=new b;if(void 0===n){var i=this.get(e);if(i){var s=!0,o=!1,u=void 0;try{for(var c,l=i.values()[Symbol.iterator]();!(s=(c=l.next()).done);s=!0){var f=c.value;t.addDailyExpensesByDate(f,a)}}catch(v){o=!0,u=v}finally{try{s||null==l.return||l.return()}finally{if(o)throw u}}}}else if(void 0===r){var d=this.get(e);if(d){var h=d.get(n);h&&t.addDailyExpensesByDate(h,a)}}else{var y=this.getExpenses({year:e,month:n,day:r});y&&t.addExpensesByDate(y.values(),a)}return a}},{key:"getExpense",value:function(e,t){var n=this.getExpenses(e);if(n)return n.get(t)}},{key:"getMonths",value:function(e){var t=this.get(e);return t?t.keys():[]}},{key:"getDays",value:function(e,t){var n=this.get(e);if(n){var r=n.get(t);return r?r.keys():[]}return[]}},{key:"years",get:function(){return this.keys()}}],[{key:"addDailyExpensesByDate",value:function(e,n){var r=!0,a=!1,i=void 0;try{for(var s,o=e.values()[Symbol.iterator]();!(r=(s=o.next()).done);r=!0){var u=s.value;t.addExpensesByDate(u.values(),n)}}catch(c){a=!0,i=c}finally{try{r||null==o.return||o.return()}finally{if(a)throw i}}}},{key:"addExpensesByDate",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new b,n=!0,r=!1,a=void 0;try{for(var i,s=e[Symbol.iterator]();!(n=(i=s.next()).done);n=!0){var o=i.value,u=t.get(o.when);u||(u=new Map,t.set(o.when,u)),u.set(o.identifier,o)}}catch(c){r=!0,a=c}finally{try{n||null==s.return||s.return()}finally{if(r)throw a}}return t}}]),t}(Object(p.a)(Map)),g=function(e){function t(){return Object(o.a)(this,t),Object(h.a)(this,Object(y.a)(t).apply(this,arguments))}return Object(v.a)(t,e),Object(u.a)(t,[{key:"addExpense",value:function(e){var t=e.month,n=this.get(t);void 0===n&&(n=new b,this.set(t,n)),n.addExpense(e)}},{key:"deleteExpense",value:function(e){var t=e.month,n=this.get(t);return!(!n||!n.deleteExpense(e))&&(0===n.size&&this.delete(t),!0)}}]),t}(Object(p.a)(Map)),b=function(e){function t(){return Object(o.a)(this,t),Object(h.a)(this,Object(y.a)(t).apply(this,arguments))}return Object(v.a)(t,e),Object(u.a)(t,[{key:"addExpense",value:function(e){var t=e.day,n=this.get(t);void 0===n&&(n=new Map,this.set(t,n)),n.set(e.identifier,e)}},{key:"deleteExpense",value:function(e){var t=e.day,n=e.identifier,r=this.get(t);return!(!r||!r.delete(n))&&(0===r.size&&this.delete(t),!0)}}]),t}(Object(p.a)(Map));n.d(t,"a",(function(){return x}));var x=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];Object(o.a)(this,e),this._info=void 0,this._expenses=void 0,this._expenseGroups=void 0,this._nestedTotalExpenses=void 0,this._days=void 0,this._totalDays=void 0,this._info=t,this._expenses=new Map;var r=!0,a=!1,i=void 0;try{for(var s,u=n[Symbol.iterator]();!(r=(s=u.next()).done);r=!0){var c=s.value;this._expenses.set(c.identifier,new f.a(c))}}catch(l){a=!0,i=l}finally{try{r||null==u.return||u.return()}finally{if(a)throw i}}}return Object(u.a)(e,[{key:"getTotalExpenses",value:function(e,t,n){var r=[e];return void 0!==t&&r.push(t),void 0!==n&&r.push(n),this.nestedTotalExpenses.getSubtotal(r)}},{key:"getExpensesByDay",value:function(e,t,n){return void 0===e?m.addExpensesByDate(this._expenses.values()):this.expenseGroups.getAllGroupedByDate(e,t,n)}},{key:"_updateTotalExpenses",value:function(e,t){void 0!==t&&t.splitInDays===e.splitInDays&&t.amountBaseCurrency===e.amountBaseCurrency&&t.when===e.when&&t.categoryId===e.categoryId&&t.countryCode===e.countryCode||(t&&this._subtractTotal(t),this._addToTotal(e))}},{key:"setExpense",value:function(e){var t=new f.a(e),n=this._expenses.get(e.identifier);if(n){var r=n.split(),a=!0,i=!1,s=void 0;try{for(var o,u=r[Symbol.iterator]();!(a=(o=u.next()).done);a=!0){var c=o.value;this.expenseGroups.deleteExpense(c)}}catch(m){i=!0,s=m}finally{try{a||null==u.return||u.return()}finally{if(i)throw s}}this._updateTotalExpenses(t,n)}else this._updateTotalExpenses(t);var l=!0,d=!1,h=void 0;try{for(var y,v=t.split()[Symbol.iterator]();!(l=(y=v.next()).done);l=!0){var p=y.value;this.expenseGroups.addExpense(p)}}catch(m){d=!0,h=m}finally{try{l||null==v.return||v.return()}finally{if(d)throw h}}this._expenses.set(e.identifier,t)}},{key:"getExpense",value:function(e){var t=this._expenses.get(e);if(t)return t;throw new Error('Expense with ID "'.concat(e,'" not found'))}},{key:"deleteExpense",value:function(e){var t=this._expenses.get(e);return!(!t||!this._expenses.delete(e))&&(this._subtractTotal(t),this.expenseGroups.deleteExpense(t),!0)}},{key:"_updateExpensesBaseAmount",value:function(t){var n=new l.a,r=!0,a=!1,i=void 0;try{for(var s,o=this._expenses.values()[Symbol.iterator]();!(r=(s=o.next()).done);r=!0){var u=s.value;u.amountBaseCurrency=e._getBaseAmount(u,t),u.addToTotals(n)}}catch(c){a=!0,i=c}finally{try{r||null==o.return||o.return()}finally{if(a)throw i}}this._nestedTotalExpenses=n}},{key:"_addToTotal",value:function(e){e.inBudgetDates(this._info)&&e.addToTotals(this.nestedTotalExpenses)}},{key:"_subtractTotal",value:function(e){e.inBudgetDates(this._info)&&e.subtractTotal(this.nestedTotalExpenses)}},{key:"setBudget",value:function(){var e=Object(s.a)(i.a.mark((function e(t,n){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.identifier===this.identifier){e.next=2;break}throw new Error("Cannot update budget information with different IDs");case 2:if(t.currency===this._info.currency){e.next=7;break}if(n){e.next=5;break}throw new Error("Required conversion rates to update budget currency");case 5:this._updateExpensesBaseAmount(n),this._info.currency=t.currency;case 7:return this._info.name=t.name,this._info.total=t.total,this._info.from!==t.from&&(this._days=this._totalDays=void 0,this._info.from=t.from),this._info.to!==t.to&&(this._days=this._totalDays=void 0,this._info.to=t.to),e.abrupt("return",Promise.resolve());case 12:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"export",value:function(e){var t={};return this._expenses.forEach((function(e,n){return t[n]=e.info})),{budgets:Object(r.a)({},this.identifier,this.info),expenses:t,categories:e,lastTimeSaved:Date.now()}}},{key:"numberOfExpenses",get:function(){return this._expenses.size}},{key:"identifier",get:function(){return this._info.identifier}},{key:"currency",get:function(){return this._info.currency}},{key:"from",get:function(){return this._info.from}},{key:"name",get:function(){return this._info.name}},{key:"to",get:function(){return this._info.to}},{key:"total",get:function(){return this._info.total}},{key:"info",get:function(){return this._info}},{key:"expenses",get:function(){return this._expenses.values()}},{key:"totalExpenses",get:function(){return this.nestedTotalExpenses.total}},{key:"nestedTotalExpenses",get:function(){var e=this;return void 0===this._nestedTotalExpenses&&(this._nestedTotalExpenses=new l.a,this._expenses.forEach((function(t){return e._addToTotal(t)}))),this._nestedTotalExpenses}},{key:"daysUntilToday",get:function(){return this._days||(this._days=Object(c.a)(this._info.from,Date.now())),this._days}},{key:"totalDays",get:function(){return this._totalDays||(this._totalDays=Object(c.a)(this._info.from,this._info.to)),this._totalDays}},{key:"average",get:function(){return this.daysUntilToday>0&&this.totalExpenses>0?Math.round(this.totalExpenses/this.daysUntilToday):0}},{key:"expectedDailyExpensesAverage",get:function(){return Math.round(this._info.total/this.totalDays)}},{key:"expenseGroups",get:function(){if(!this._expenseGroups){var e=new m;this._expenses.forEach((function(t){return t.split().forEach((function(t){return e.addExpense(t)}))})),this._expenseGroups=e}return this._expenseGroups}}],[{key:"_getBaseAmount",value:function(e,t){var n=e.currency,r=e.amount;if(t.base===n)return r;var a=t.rates[n];if(void 0===a)throw new Error("Cannot get currency exchange rate from ".concat(t.base," to ").concat(n));return Object(d.a)(r,a)}}]),e}()},328:function(e,t,n){"use strict";n.r(t);var r=n(2),a=n.n(r),i=n(4),s=n(16),o=n(0),u=n.n(o),c=n(146),l=n(148),f=n(14),d=n(18),h=n(60),y=n(55),v=n(59),p=function(e){function t(e){return Object(f.a)(this,t),Object(h.a)(this,Object(y.a)(t).call(this,t.combine(e),t.combineExpenses(e.map((function(e){return e.expenses})))))}return Object(v.a)(t,e),Object(d.a)(t,null,[{key:"combine",value:function(e){return{identifier:e.map((function(e){return e.identifier})).join("+"),currency:e[0].currency,from:e.map((function(e){return e.from})).reduce((function(e,t){return Math.min(e,t)})),to:e.map((function(e){return e.to})).reduce((function(e,t){return Math.max(e,t)})),name:e.map((function(e){return e.name})).join("+"),total:e.map((function(e){return e.total})).reduce((function(e,t){return e+t}))}}},{key:"combineExpenses",value:function(e){return e.reduce((function(e,t){return[].concat(Object(l.a)(e),Object(l.a)(t))}))}}]),t}(n(212).a),m=n(196),g=n(210),b=n(144),x=n(140),E=n(51),k=n(134),_=n(166);n.d(t,"BudgetCombinedView",(function(){return w}));var w=function(e){var t=new URLSearchParams(e.location.search),n=Object(c.a)(),r=Object(_.a)(),o=u.a.useState(),l=Object(s.a)(o,2),f=l[0],d=l[1],h=Object(E.a)();return Object(x.a)(h("Combined budgets"),u.a.createElement(b.b,{history:e.history}),e),u.a.useEffect((function(){function e(){return(e=Object(i.a)(a.a.mark((function e(n){var r,i,s,o,u,c,l,f;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=[],i=!0,s=!1,o=void 0,e.prev=4,u=t.values()[Symbol.iterator]();case 6:if(i=(c=u.next()).done){e.next=16;break}return l=c.value,e.t0=r,e.next=11,n.getBudgetModel(l);case 11:e.t1=e.sent,e.t0.push.call(e.t0,e.t1);case 13:i=!0,e.next=6;break;case 16:e.next=22;break;case 18:e.prev=18,e.t2=e.catch(4),s=!0,o=e.t2;case 22:e.prev=22,e.prev=23,i||null==u.return||u.return();case 25:if(e.prev=25,!s){e.next=28;break}throw o;case 28:return e.finish(25);case 29:return e.finish(22);case 30:f=new p(r),d(f);case 32:case"end":return e.stop()}}),e,null,[[4,18,22,30],[23,,25,29]])})))).apply(this,arguments)}n&&function(t){e.apply(this,arguments)}(n)}),[n]),f?u.a.createElement(u.a.Fragment,null,u.a.createElement(m.a,{dailyAverage:f.average,expectedDailyAverage:f.expectedDailyExpensesAverage,passedDays:f.daysUntilToday,totalDays:f.totalDays,totalBudget:f.total,totalSpent:f.totalExpenses}),u.a.createElement(g.a,{categories:r,budget:f})):u.a.createElement(k.a,null)};t.default=w}}]);
//# sourceMappingURL=11.faec7185.chunk.js.map