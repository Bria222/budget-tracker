{"version":3,"sources":["domain/stores/CategoriesStoreImpl.ts"],"names":["CategoriesStoreImpl","storage","_categories","_storage","_loading","this","addObserver","undefined","getCategories","categories","cs","forEach","c","identifier","setCategories","categoryId","deleteCategory"],"mappings":"8NAIaA,EAAb,WAMI,WAAYC,GAAyB,yBAJ7BC,iBAI4B,OAHnBC,cAGmB,OAF5BC,cAE4B,EAChCC,KAAKF,SAAWF,EAChBI,KAAKF,SAASG,YAAYD,MARlC,mEAYQA,KAAKH,iBAAcK,IAZ3B,mJAgBaF,KAAKH,YAhBlB,uBAiBiBG,KAAKD,WACNC,KAAKD,SAAWC,KAAKF,SAASK,iBAlB9C,SAoBqCH,KAAKD,SApB1C,OAoBYC,KAAKH,YApBjB,uCAsBeG,KAAKH,aAtBpB,mLAyBwBO,GAzBxB,uFA0ByBJ,KAAKG,gBA1B9B,cA0BcE,EA1Bd,OA2BQD,EAAWE,SAAQ,SAAAC,GAAC,OAAIF,EAAGE,EAAEC,YAAcD,KA3BnD,kBA4BeP,KAAKF,SAASW,cAAcL,IA5B3C,kLA+BsBM,GA/BtB,uFAgCiCV,KAAKG,gBAhCtC,cAgCcC,EAhCd,yBAiCeA,EAAWM,IAjC1B,qLAoCyBA,GApCzB,uFAqCiCV,KAAKG,gBArCtC,UAqCcC,EArCd,SAsCYM,KAAcN,GAtC1B,uBAuCYJ,KAAKF,SAASa,eAAeD,UACtBN,EAAWM,GAxC9B,mBAyCmB,GAzCnB,iCA2Ce,GA3Cf","file":"static/js/9.86cb05ad.chunk.js","sourcesContent":["import { CategoriesMap, Category } from \"../../api\";\nimport { AppStorageApi, StorageObserver } from \"../../services/storage/StorageApi\";\nimport { CategoriesStore } from './interfaces';\n\nexport class CategoriesStoreImpl implements CategoriesStore, StorageObserver {\n\n    private _categories?: CategoriesMap;\n    private readonly _storage: AppStorageApi;\n    private _loading?: Promise<CategoriesMap>;\n\n    constructor(storage: AppStorageApi) {\n        this._storage = storage;\n        this._storage.addObserver(this);\n    }\n\n    onStorageDataChanged(){\n        this._categories = undefined;\n    }\n\n    async getCategories() {\n        if (!this._categories) {\n            if (!this._loading) {\n                this._loading = this._storage.getCategories();\n            }\n            this._categories = await this._loading;\n        }\n        return this._categories;\n    }\n\n    async setCategories(categories: Category[]){\n        const cs = await this.getCategories();\n        categories.forEach(c => cs[c.identifier] = c)\n        return this._storage.setCategories(categories);\n    }\n\n    async getCategory(categoryId: string) { \n        const categories = await this.getCategories();\n        return categories[categoryId];\n    }\n\n    async deleteCategory(categoryId: string) {\n        const categories = await this.getCategories();\n        if (categoryId in categories) {\n            this._storage.deleteCategory(categoryId);\n            delete categories[categoryId];\n            return true;\n        }\n        return false;\n    }\n}\n"],"sourceRoot":""}